<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Pedro J. Aphalo" />

<meta name="date" content="2021-01-27" />

<title>Extensions to the Grammar of Graphics</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Extensions to the Grammar of Graphics</h1>
<h3 class="subtitle">Data labels are not annotations</h3>
<h4 class="author">Pedro J. Aphalo</h4>
<h4 class="date">2021-01-27</h4>


<div id="TOC">
<ul>
<li><a href="#preliminaries">Preliminaries</a></li>
<li><a href="#introduction-to-the-extensions">Introduction to the extensions</a>
<ul>
<li><a href="#data-labels-annotations-and-insets">Data labels, annotations and insets</a></li>
<li><a href="#annotations-in-ggplot2">Annotations in ‘ggplot2’</a></li>
<li><a href="#extending-ggplot2">Extending ‘ggplot2’</a></li>
<li><a href="#when-to-use-annotations-and-when-insets">When to use annotations and when insets</a></li>
<li><a href="#positioning-data-labels">Positioning data labels</a></li>
<li><a href="#highlighting-data-features">Highlighting data features</a></li>
<li><a href="#local-density-of-observations">Local density of observations</a></li>
<li><a href="#summary-statistics">Summary statistics</a></li>
<li><a href="#ggplot-methods">ggplot methods</a></li>
<li><a href="#thoughts-for-the-future">Thoughts for the future</a></li>
<li><a href="#list-of-references">List of references</a></li>
</ul></li>
<li><a href="#examples">Examples</a>
<ul>
<li><a href="#ggplot-methods-1">ggplot methods</a></li>
<li><a href="#geometries">Geometries</a>
<ul>
<li><a href="#geom_table-and-stat_fmt_table">geom_table() and stat_fmt_table()</a></li>
<li><a href="#geom_plot">geom_plot()</a></li>
<li><a href="#geom_grob">geom_grob()</a></li>
<li><a href="#geom_vhlines">geom_vhlines</a></li>
<li><a href="#normalised-parent-coordinates">Normalised Parent Coordinates</a></li>
<li><a href="#marginal-markings">Marginal markings</a></li>
</ul></li>
<li><a href="#statistics">Statistics</a>
<ul>
<li><a href="#stat_centroid">stat_centroid()</a></li>
<li><a href="#stat_quadrant_counts-and-geom_quadrant_lines">stat_quadrant_counts() and geom_quadrant_lines()</a></li>
<li><a href="#stat_apply_group-and-stat_apply_panel">stat_apply_group and stat_apply_panel</a></li>
<li><a href="#stat_peaks-and-stat_valleys">stat_peaks() and stat_valleys()</a></li>
<li><a href="#stat_dens2d_labels-and-stat_dens2d_filter">stat_dens2d_labels() and stat_dens2d_filter()</a></li>
<li><a href="#stat_dens1d_labels-and-stat_dens1d_filter">stat_dens1d_labels() and stat_dens1d_filter()</a></li>
<li><a href="#repulsion-with-ggrepel">Repulsion with ggrepel</a></li>
</ul></li>
<li><a href="#appendix-a-more-on-density-filtering">Appendix A: More on density filtering</a></li>
<li><a href="#appendix-b-try_tibble">Appendix B: try_tibble()</a>
<ul>
<li><a href="#time-series">Time series</a></li>
<li><a href="#other-classes">Other classes</a></li>
</ul></li>
</ul></li>
</ul>
</div>

<div id="preliminaries" class="section level2">
<h2>Preliminaries</h2>
<p>We load all the packages used in the examples.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span></code></pre></div>
<p>As we will use text and labels on the plotting area we change the default theme to an uncluttered one.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>old_theme <span class="ot">&lt;-</span> <span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code></pre></div>
</div>
<div id="introduction-to-the-extensions" class="section level1">
<h1>Introduction to the extensions</h1>
<div id="data-labels-annotations-and-insets" class="section level2">
<h2>Data labels, annotations and insets</h2>
<p><em>Data labels</em> add textual information directly related to individual data points (shown as glyphs). Text position in this case is dependent on the scales used to represent data points. Text is usually displaced so that it does not occlude the glyph representing the data point and when the link to the data point is unclear, this link is signaled with a line segment or arrow. Data labels are distinct from annotations but instead contribute to the representation of data on a plot or map.</p>
<p><em>References</em> are lines, shading or marks used to help the reading of a plot. These elements are used to highlight specific values on an axis or a region in a plot. They, like data labels, are positioned relative to the scales used for data. The position of data labels and lines, glyphs or shading used as reference cannot be altered by the designer of a plot, as the position conveys information. I will use the term <em>data labels</em> irrespective if the “labels” are textual or graphical, like icons and small plots and simple tables linked to data points or map features.</p>
<p>According to Koponen and Hildén (2019), “[in a statistical chart] annotations can be used to draw reader attention to relevant detail”. These authors use as an example a text box in a plot to highlight a data point that is off-scale and has been “squeezed” to a position immediately outside the plotting area.</p>
<p><em>Annotations</em> differ from data labels, in that their position is decoupled from their meaning. Insets can be thought as larger, but still self-contained annotations. In most cases the reading of inset tables and plots depends only weakly on the plot or map in which they are included.</p>
<p>In the case of annotations and insets the designer of a data visualization has the freedom to locate them anywhere, as long they do not occlude features used to describe data. I will use the term <em>annotation</em> irrespective if the “labels” are textual or graphical. Insets are similar to annotations, but the term <em>inset</em> is used when an annotation’s graphical or textual element is complex and occupies more space within the plotting area. Insets can be moved from within the main plotting area to being adjacent to it, e.g., as a smaller panel, without any loss of meaning .</p>
<p>That the position of annotations and insets is independent of the plotted data cannot be expressed using the grammar of graphics (GG) as implemented in package ‘ggplot2’.</p>
</div>
<div id="annotations-in-ggplot2" class="section level2">
<h2>Annotations in ‘ggplot2’</h2>
<p>In <em>The Layered Grammar of Graphics</em> (Wickham 2000) as implemented in package ‘ggplot2’ (Wickham et al. 2016) annotations are “second class” features. As layers they behave differently than data layers: Only constant values can be mapped to aesthetics and do no support faceting into panels. In escence <code>annotate()</code> disconnects the resulting plot elements from the data source and facetting, but not from the scales used to graphically display the data values.</p>
<p>From the data visualization perspective the main practical and conceptual difference between data labels and annotations is in the scales used to position them within the plotting area. Instead of using an <code>annotate()</code> function that deviates from the grammar of graphics to implement annotations, we could retain the use of the grammar of graphics for annotations but add support of native plot coordinates (npc). Support of annotations done in this way would allow “annotation layers” to behave almost identically to “data layers”, and use the same grammar. The <em>x</em> and <em>y</em> position aesthetics used for data could be supplemented with pseudo-aesthetics without any translation relative to the native plotting coordinates of the plotting area or viewport. Doing so, would allow the graphic design flexibility conceptually inherent to annotations within a user-friendly syntax.</p>
</div>
<div id="extending-ggplot2" class="section level2">
<h2>Extending ‘ggplot2’</h2>
<p>Based on this insight, a new approach to adding annotations and insets was implemented in package ‘ggpmisc’ (&gt;= 0.3.1) through two new <em>x</em> and <em>y</em> pseudo-aesthetics, <em>npcx</em> and <em>npcy</em>, and corresponding dumb scales and various geometries that make use of them. These scales and geometries were implemented as an extension to package ‘ggplot2’.</p>
<p>Before showing how this works in practice, we load the package and set an uncluttered theme as default.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpmisc)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()))</span></code></pre></div>
<p>Native plot coordinates have range 0..1. However, the “npc” geoms also recognize some positions by name with the same text strings as used for text justification in ‘ggplot2’. The default justification is <code>&quot;inward&quot;</code>, as this protects from clipping at the edges the plotting area irrespective the arguments passed to the <code>witdth</code> and <code>height</code> parameters of R’s graphic devices.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg)) <span class="sc">+</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_npc</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;left&quot;</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">&quot;top&quot;</span>, <span class="st">&quot;bottom&quot;</span>),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Most</span><span class="sc">\n</span><span class="st">efficient&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                                            <span class="st">&quot;Least</span><span class="sc">\n</span><span class="st">efficient&quot;</span>)),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">npcx =</span> x, <span class="at">npcy =</span> y, <span class="at">label =</span> label),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">3</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>p1</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The advantage of this approach becomes apparent when the limits of the <em>y</em> scale are unknown or vary. When a script or user defined plotting function sets the scale limits based on the input data, in the absence of the extensions proposed here, setting annotations consistently within the plotting area becomes laborious. The example below, shows how the annotations remain at the desired position when the <em>y</em> scale limts are expanded.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">+</span> <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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I1BII1BII1BII1BII1BII1Bok3lgeYNhgF8ECmkECmkECmkEClcskqCMbSZII1BII1Bo4xoUWESgkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagkEagcMV3dUIZ3xcPacKB9l91jBm+rh9cLw5DeegGelN/2jG3pyfm6tniMJSI6jXohyf/SGbQ4dvOeCadGwb45XyK7x9dm+GbMzvE8v+VAWaDQG8OpoHODgP8yjCDzg4D/HIOlGtQFME50NvTY1bxyB37oJDGnSRII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BI8xNoXLtcenzw9fLjwAPyDfSh48ADvAbai6KKMV37ftSMov3k3SMKxSZ8BmrfnzeS94Ov2r2KSd4zg2JDPgNNJtBk2jRxNdppJe8qnOKxMa+BVuzHvd324HnL2E4bBIoNeT3FP26Nmo0k095Oq5vEer5PoNiQp0CrkV0ZpYukwWH0q8OGOY+SBdLgkEUSNsJGPaQRKKQRKKQRKKQRKKQRKKQRKKQRKKR5DXTUjBrJ24vJ/aP5+0g8GwoHXgO1RT54d5PbnnDgKdDpTc7dH5K372uXcTXatQ/bpcfjLw6jCs+GwoW/h0XOG9MZNK59et4y3Upcuxg/IbrX5tlQuPET6PRJ0GmgF5MHmD+mx5NDo3ctAoUDT4GmT4IuCbQyOUygcOMe6PB1/eB6cdgDxk+Czp/ie48uahfpcQKFM+dAb09PzNWzxWEPGX+73F2gC4ukNFCeDYUD50CHbzum/6qzMAzwyznQ/tG1Gb45s0Msv18VMOEc6M3BNNDZYYBfGWbQ2WGAX1yDQtoGq/jjDVbxwC/Dzz4o8AvheVBII1BII1BII1BII1BII1BII1BII1BII1BIyxookI9sgRYh+FmbF7AFAvWPF7AFAvWPF7CFAAJFmREopBEopBEopBEopOkHan+0ScBuT+tPztZ/mq7+y/rTzvpP80U/0Kt60IF+OEl/tECw7LecXxX4AuQD7f/+u5ADtd+1HbT05yIU+CLUA7392z+DPsX3j/4e9imeGXS1q+Owr0H7L0/SSShcc992nj/xQJP/t4EHOveTgwLU//bM3BS4ShIP9KpuHRf9ZWQ3/EPggc7/8Lj8iQdqgt9m+hD4KZ4ZdJ3AA00u4YrcRtzeTb3QVZ5+oCg1AoU0AoU0AoU0AoU0AoU0At1eN9ppLR77778Xj9i/gm9e/Lg1eP7ZSMwh0K0NDhfLS9tbPNStLPukHn/t3moEurUlMS45tmSutJ/0+byKOQS6rbia/j2k1fQvIk+Cm/5uf/Kxiff+FO22u3aqnBw5t5Npt5JWzBS6GoFuzXaWnua7u+1Rs5J+PJ4cK+lbXK3YNNN6x3/a223bqTMNdNn8i3sEujWb2M+X4w+muaWXl0mG9l1cbUwuVKd/mia8105/u+wKFvcIdGvj7HrJKX6nlUZpZtY/02jTDqd/ahdMyT/pH6RTKx5EoFsbn+J3WvYDx0DjvR+bDQJ1QaBbu4uxtzN/ire7o/YUfxfo3fXmqPlir204xTsg0K1NY4yrO63pwshmd7dISrM8nyyS7Jvd269MemWRtBqBbi1N7Dy5Av1LWmW6kZT8vnK3zTS+Rp3ZZrJ7U9MJtcs200oEmpP5jfpkDT/+gI36NQg0L3O3OrvTlRH79GsQaF5m5sq4Os2Sh0XWIVBII1BII1BII1BII1BII1BII1BI+x8wuNKhcGwZBwAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>To support the existing syntax for annotations using the new geometries, function <code>ggplot2::annotate()</code> is overridden when package ‘ggpmisc’ is loaded. The new definition adds support for the new pseudo-aesthetics <em>npcx</em> and <em>npcy</em> retaining its original ‘ggplot2’ behaviour in all other respects.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg)) <span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;text_npc&quot;</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">npcx =</span> <span class="fu">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;left&quot;</span>),</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">npcy =</span> <span class="fu">c</span>(<span class="st">&quot;top&quot;</span>, <span class="st">&quot;bottom&quot;</span>),</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;Most</span><span class="sc">\n</span><span class="st">efficient&quot;</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>                     <span class="st">&quot;Least</span><span class="sc">\n</span><span class="st">efficient&quot;</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Inset plots can be added with the same syntax using <code>geom_plot_npc()</code>. They can be thought also as being annotations. Here we use <code>annotate()</code> but <code>geom_plot()</code> can be also used directly, in which case the inset plots can be different for each panel.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), mpg, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>(<span class="dv">9</span>) <span class="sc">+</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;plot_npc&quot;</span>, <span class="at">npcx =</span> <span class="st">&quot;left&quot;</span>, <span class="at">npcy =</span> <span class="st">&quot;bottom&quot;</span>, <span class="at">label =</span> p2) <span class="sc">+</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">0</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A simple example with facets, labeling of panels in a traditional way as requiered by some book and journal styles. In this case panel tags within the plotting are at same “npc” location with free scale limits in panels.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(wt, mpg)) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_npc</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">cyl =</span> <span class="fu">levels</span>(<span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl)),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">label =</span> LETTERS[<span class="fu">seq_along</span>(<span class="fu">levels</span>(<span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl)))],</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">x =</span> <span class="fl">0.90</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">y =</span> <span class="fl">0.95</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">npcx =</span> x, <span class="at">npcy =</span> y, <span class="at">label =</span> label),</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">factor</span>(cyl), <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This approach was first implemented in ‘ggpmisc’ version 0.3.1 released in April 2919. As of version &gt;= 0.3.8, the implementation can be considered fairly stable. However, this implementation is to an extent dependent on undocumented behaviour of ‘ggplot2’ functions, which means that future updates to ‘ggplot2’ can break this functionality.</p>
</div>
<div id="when-to-use-annotations-and-when-insets" class="section level2">
<h2>When to use annotations and when insets</h2>
<p>Package ‘ggpmisc’ adds support for various plot annotations and reference guides. It also adds support for some data labels related to data features. While developing these statistics, it became clear that expanding the grammar of graphics’s support for annotations would simplify the code of these statistics considerably and also more cleanly separate the computations on data from the positioning of annotations.</p>
<p><strong>Table</strong>. Geometries useful for data labels and annotations. Currently implemented <em>ordinary</em> geometries and their <em>npc</em> versions. The rightmost column shows the expected class of the objects mapped to the <code>label</code> aesthetic. When using <code>annotate()</code> to add a single plot, table or grob as an inset, enclosing them in a list is allowed, but not a requirement.</p>
<table>
<thead>
<tr class="header">
<th>Data labels (data coordinates)</th>
<th>Annotations (npc)</th>
<th>Mapped to <code>label</code> aesthetic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ggplot2::geom_text()</code></td>
<td><code>geom_text_npc()</code></td>
<td><code>character</code> vector</td>
</tr>
<tr class="even">
<td><code>ggplot2::geom_label()</code></td>
<td><code>geom_label_npc()</code></td>
<td><code>character</code> vector</td>
</tr>
<tr class="odd">
<td><code>geom_plot()</code></td>
<td><code>geom_plot_npc()</code></td>
<td><code>list()</code> of <code>ggplot2::gg</code></td>
</tr>
<tr class="even">
<td><code>geom_table()</code></td>
<td><code>geom_table_npc()</code></td>
<td><code>list()</code> of <code>data.frame</code></td>
</tr>
<tr class="odd">
<td><code>geom_grob()</code></td>
<td><code>geom_grob_npc()</code></td>
<td><code>list()</code> of <code>grid::grob</code></td>
</tr>
</tbody>
</table>
<p>When adding an informative element to a plot, assess whether it is an <em>annotation</em> or a <em>data label</em>. To decide on the best approach, consider if the location of the element is more “naturally” expressed in the original data units or as position relative to the edges or centre of the plotting area. In the second case, prefer the “npc” geoms as you are dealing with <em>annotations</em>, otherwise, use the ordinary geometries as you are dealing with data labels or data points.</p>
</div>
<div id="positioning-data-labels" class="section level2">
<h2>Positioning data labels</h2>
<p>Nudging is normally used to displace text labels so that they do not overlap the points or lines representing the data being labeled. Two enhanced versions of <code>position_nudge()</code> are provided, <code>position_nudge_center()</code> and <code>position_nudge_line()</code>. These functions make it possible to apply nudging that varies automatically according to the relative position of points with respect to arbitrary points or lines, or with respect to a polynomial or smoothing spline fitted on-the-fly to the the observations.</p>
</div>
<div id="highlighting-data-features" class="section level2">
<h2>Highlighting data features</h2>
<p>If maxima or minima are to be labeled in a plot, this can be automated so that the feature and its labelling is automated. This is possible with <code>stat_peaks()</code> and <code>stat_valleys()</code>. Marginal annotations with symbols and vertical and horizontal lines can be used to highlight summary values or events/conditions. The <em>geoms</em> <code>geom_quadrant_lines()</code>, <code>geom_vhlines()</code>, <code>geom_x_margin_arrow()</code>, <code>geom_x_margin_grob()</code>, <code>geom_x_margin_point()</code>, <code>geom_y_margin_arrow()</code>, <code>geom_y_margin_grob()</code> and <code>geom_y_margin_point()</code> make such labelling easy.</p>
</div>
<div id="local-density-of-observations" class="section level2">
<h2>Local density of observations</h2>
<p>There are to aspects to this: highlighting with colours dense or sparse regions, or using density to decide which observations to label. In this cases we can use <code>stat_dens1d_labels()</code> and <code>stat_dens2d_labels()</code>, <code>stat_dens1d_filter()</code> and <code>stat_dens2d_filter()</code>, and <code>stat_dens1d_filter_g()</code> and <code>stat_dens2d_filter_g()</code>.</p>
</div>
<div id="summary-statistics" class="section level2">
<h2>Summary statistics</h2>
<p>With some types of data it is common to compute summary per quadrant, rather than based on a prior grouping. The <em>stat</em> <code>stat_quadrant_counts()</code> can de used to annotate plots with the number of observations in each quadrant. <code>stat_summary_xy()</code> is similar to <code>stat_summary()</code> from ‘ggplot2’ but useful when both <em>x</em> and <em>y</em> are continuous variables. It allows the use the same, or different functions to summarise the data over <em>x</em> and <em>y</em>. In contrast <code>stat_centroid()</code> always applies the same function over <em>x</em> and <em>y</em>.</p>
</div>
<div id="ggplot-methods" class="section level2">
<h2>ggplot methods</h2>
<p>Being <code>ggplot()</code> defined as a generic method in ‘ggplot2’ makes it possible to define specializations, and we provide two for time series stored in objects of classes <code>ts</code> and <code>xts</code> which automatically convert these objects into tibbles and set by default the aesthetic mappings for <code>x</code> and <code>y</code> automatically. A companion function <code>try_tibble()</code> is also exported.</p>
</div>
<div id="thoughts-for-the-future" class="section level2">
<h2>Thoughts for the future</h2>
<p>Although we have discussed only scales for <em>x</em> and <em>y</em> aesthetics, the same consideration applies to other aesthetics like <em>colour</em>. It seems generally useful to allow aesthetics to use a different scale for annotations than for data. Defining pseudo-aesthetics for annotations instead of allowing multiple scales for each aesthetic in a plot would add flexibility while still keeping the guarantee that the meaning of aesthetics values remains consistent across all plot elements representing data.</p>
</div>
<div id="list-of-references" class="section level2">
<h2>List of references</h2>
<p>Koponen, J; Hildén, J. (2019) <em>Data visualization handbook</em>. Aalto ARTS books, Espoo. ISBN 978-952-60-7449-8.</p>
<p>Wickham H. (2010) A Layered Grammar of Graphics. <em>Journal of Computational and Graphical Statistics</em> <strong>19:</strong> 3–28.</p>
<p>Wickham H. (2016) <em>ggplot2</em>. Springer International Publishing. ISBN 978-3-319-24275-0.</p>
</div>
</div>
<div id="examples" class="section level1">
<h1>Examples</h1>
<div id="ggplot-methods-1" class="section level2">
<h2>ggplot methods</h2>
<p><code>ggplot()</code> methods for classes <code>&quot;ts&quot;</code> and <code>&quot;xts&quot;</code> automate plotting of time series data, as <em>x</em> and <em>y</em> aesthetics are mapped to time and the variable of the time series, respectively. For plotting time series data stored in objects of other classes, see the conversion functions <code>try_tibble()</code> and <code>try_data_frame()</code> in the last section of this vignette.</p>
<p>By default, <code>time</code> is of class <code>Date</code> or of class <code>POSIXct</code> depending on how time is stored in the time series object. On-the-fly coversion of <code>time</code> to <code>numeric</code> is possible (shown in the second example below).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(lynx)</span></code></pre></div>
<pre><code>## [1] &quot;ts&quot;</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lynx) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Whether the class variable <code>time</code>affects the scale used by default as well as the formatting of values when converted to character strings or printed.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lynx, <span class="at">as.numeric =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_line</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="geometries" class="section level2">
<h2>Geometries</h2>
<p>Three on the geometries described below allow the addition of plot layers containing insets. Insets can be plots, tables, bitmaps, or grid objects. Insets can be also added as annotations. Using for <code>data</code> a tibble with a list column containing data frames or tibbles allows like any other geom, the use of grouping, multiples insets per panel, faceting with different tables, and different number of insets in each panel, i.e., individual tables added to a plot with <code>geom_table</code> behave similarly to individual character values added with <code>geom_text</code>.</p>
<p>Other geometries also described in this section support the use of native plot coordinates for positioning elements in the plotting area. Obviously these geometries are not meant to display data, but instead to be able to add annotations to plots consistently across data sets and varying scales used.</p>
<div id="geom_table-and-stat_fmt_table" class="section level3">
<h3>geom_table() and stat_fmt_table()</h3>
<p>The <em>geometry</em> <code>geom_table()</code> plots a data frame or tibble, nested in a tibble passed as data argument, using <em>aesthetics</em> <code>x</code> and <code>y</code> for positioning, and <code>label</code> for the list of data frames containing the data for the tables. The tables are created as a ‘grid’ grobs and added as usual to the ggplot object. In contrast to “standard” geoms, this geom by default does not inherit the globally mapped aesthetics.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hwy =</span> <span class="fu">median</span>(hwy), <span class="at">cty =</span> <span class="fu">median</span>(cty))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">tb =</span> <span class="fu">list</span>(tb))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb)) <span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In plots with a single panel it is easier to use <code>annotate()</code> to add inset tables, giving the same plot as above. In this case single data frames, ggplots or grobs do not need to be wrapped in a list, although lists are also supported.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hwy =</span> <span class="fu">median</span>(hwy), <span class="at">cty =</span> <span class="fu">median</span>(cty))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;table&quot;</span>, <span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">label =</span> tb) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p>Table themes are supported through parameter <code>table.theme</code> and if variables or constants are mapped to the <code>colour</code>, <code>fill</code>, <code>size</code>, <code>family</code>, aesthetics they override the corresponding theme settings. The display of <code>rownames</code> and <code>colnames</code> can be enabled or disable through parameter <code>table.rownames</code> and <code>table.colnames</code> and the horizontal justification of text in the core of the table through parameter <code>table.hjust</code>.</p>
<p>Parameter <code>table.theme</code> accepts as arguments <code>NULL</code> for use of the current default, a <code>ttheme</code> constructor function such as those defined in package ‘gridExtra’, or the variations on them defined in this package. The current default can be set with function <code>ttheme_set()</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">table.theme =</span> ttheme_gtsimple,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">table.hjust =</span> <span class="dv">0</span>, <span class="at">colour =</span> <span class="st">&quot;darkred&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;#FFFFBB&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using <code>stat_fmt_tb()</code> we can rename columns and rows of the tibble, reorder them and/or select a subset of columns or rows as shown below. To provide a complete example we also replace the names of the scales for <em>x</em>, <em>y</em> and <em>color</em> aesthetics. Here we pass a <code>character</code> vector with the original names of the columns in full, but partial matching is tried when needed. It is also possible to use a <code>numeric</code> vector of positional indexes.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb),</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">table.theme =</span> ttheme_gtlight,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">stat =</span> <span class="st">&quot;fmt_tb&quot;</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">tb.vars =</span> <span class="fu">c</span>(<span class="at">Cylinders =</span> <span class="st">&quot;cyl&quot;</span>, <span class="at">MPG =</span> <span class="st">&quot;hwy&quot;</span>), <span class="co"># rename</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">tb.rows =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">1</span>) <span class="sc">+</span> <span class="co"># change order</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Parsed text, using plot math syntax is supported in the table, with fall-back to plain text in case of parsing errors, on a cell by cell basis. Here we plot the MPG for city traffic and we can see that the plotting area expands to include the coordinates at which the table is anchored. Justification is by default set to <code>&quot;inward&quot;</code> which ensures that the table is fully within the plotting region.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>tb.pm <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">&quot;frac(beta[1], a^2)&quot;</span>, <span class="st">&quot;frac(beta[2], a^3)&quot;</span>),</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">Value =</span> <span class="fu">c</span>(<span class="st">&quot;10^2.4&quot;</span>, <span class="st">&quot;10^3.532&quot;</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">tb =</span> <span class="fu">list</span>(tb.pm))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, cty)) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_table</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> tb), <span class="at">parse =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>As implemented, there is no limitation to the number of insets, and faceting is respected. If the base plot shows a map, multiple small tables could be superimposed on different countries or regions. The size of the insets is set relative to the main plot, so the combined plot can be scaled.</p>
<p>Please see section <strong>Normalised Parent Coordinates</strong> below for a description of <code>geom_table_npc()</code>.</p>
</div>
<div id="geom_plot" class="section level3">
<h3>geom_plot()</h3>
<p>The <code>geom_plot()</code> <em>geometry</em> plots ggplot objects, nested in a tibble passed as data argument, using <em>aesthetics</em> <code>x</code> and <code>y</code> for positioning, and <code>label</code> for the ggplot object containing the definition of the plot to be nested. With this approach in plots with facets the insets can be different in each panel. It is also possible to inset more than one plot in a single call simply by creating a tibble with multiple rows.</p>
<p>Behind the scenes, one Grob is created for each plot to be inset. The conversion is done with <code>ggplotGrob()</code> and the Grobs added the main ggplot object.</p>
<p>As an example we produce a plot where the inset plot is a zoomed-in detail from the main plot. In this case the main and inset plots start as the same plot. In most cases the size of text and other elements in the inset should be smaller than in the main plot. Here we override the default theme setting the <code>base_size</code> from its default of 11 pt to 8 pt.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">plot =</span> <span class="fu">list</span>(p <span class="sc">+</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">4.9</span>, <span class="fl">6.2</span>), </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">theme_bw</span>(<span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">scale_colour_discrete</span>(<span class="at">guide =</span> <span class="cn">FALSE</span>)))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_plot</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> plot)) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">&quot;rect&quot;</span>, </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">xmin =</span> <span class="fl">4.9</span>, <span class="at">xmax =</span> <span class="fl">6.2</span>, <span class="at">ymin =</span> <span class="dv">13</span>, <span class="at">ymax =</span> <span class="dv">21</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In general, the inset plot can be any ggplot object, allowing the creation of very different combinations of main plot and inset plots. Here we use the inset to show summaries as in the previous example of an inset table.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), hwy, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;col&quot;</span>, <span class="at">fun =</span> mean, <span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of cylinders&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;Means&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">guide =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot =</span> <span class="fu">list</span>(p <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                                <span class="fu">theme_bw</span>(<span class="dv">8</span>)))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_plot</span>(<span class="at">data =</span> data.tb, <span class="fu">aes</span>(x, y, <span class="at">label =</span> plot)) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The same plot as above can be created using <code>annotate()</code> but be aware that when using facets in ‘ggplot2’ annotations are identical in all panels.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="fu">factor</span>(cyl), hwy, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;col&quot;</span>, <span class="at">fun =</span> mean, <span class="at">width =</span> <span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Number of cylinders&quot;</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">&quot;Means&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">guide =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;plot&quot;</span>, <span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">44</span>, <span class="at">label =</span> p <span class="sc">+</span> <span class="fu">theme_bw</span>(<span class="dv">8</span>)) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p>As implemented, there is no limitation to the number of insets, and faceting is respected. If the base plot shows a map or a bitmap, multiple small plots could be superimposed on different countries or regions. The size of the insets is set relative to the main plot, so the combined plot can be scaled. A possible unintuitive but useful feature, is that the theme is linked to each plot.</p>
<p>Please see section <strong>Normalised Parent Coordinates</strong> below for a description of <code>geom_plot_npc()</code>.</p>
</div>
<div id="geom_grob" class="section level3">
<h3>geom_grob()</h3>
<p>The <code>geom_grob()</code> <em>geometry</em> plots grobs (graphical objects as created with ‘grid’), nested in a tibble passed as data argument, using <em>aesthetics</em> <code>x</code> and <code>y</code> for positioning, and <code>label</code> for the Grob object. While <code>geom_table()</code> and <code>geom_plot()</code> take as values to plot tibbles or data frames, and ggplots, respectively, and convert them into Grobs before adding them to the plot, <code>geom_grob()</code> expects Grobs ready to be rendered.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>file.name <span class="ot">&lt;-</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Isoquercitin.png&quot;</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">package =</span> <span class="st">&quot;ggpmisc&quot;</span>, <span class="at">mustWork =</span> <span class="cn">TRUE</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>Isoquercitin <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_read</span>(file.name)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>grobs.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">40</span>), <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">9</span>),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">width =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="dv">1</span>),</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">height =</span>  <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.3</span>),</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">grob =</span> <span class="fu">list</span>(grid<span class="sc">::</span><span class="fu">circleGrob</span>(), </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">rectGrob</span>(), </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">textGrob</span>(<span class="st">&quot;I am a Grob&quot;</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                               grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Isoquercitin)))</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_grob</span>(<span class="at">data =</span> grobs.tb, </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(x, y, <span class="at">label =</span> grob, <span class="at">vp.width =</span> width, <span class="at">vp.height =</span> height),</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">0.7</span>, <span class="at">vjust =</span> <span class="fl">0.55</span>) <span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.3</span>, <span class="at">add =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fl">0.2</span>, <span class="at">add =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_bw</span>(<span class="dv">12</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>As shown above for inset tables and inset plots, it is also possible to use <code>annotate()</code> with Grobs. The next example insets a single <code>Grob</code>. Here we reuse the bitmap <code>Isoquercitin</code> read in the previous example. The Grob is contained in a viewport. Here setting <code>width = 1</code> (“npc” units) when creating the <code>Grob</code> from the bitmap ensures that the bitmap fills the width of the viewport (to ensure that the inset is not distorted, set only one of <code>width</code> or <code>height</code>). The argument to <code>vp.width</code> or <code>vp.height</code>, also in “npc” units, determines the size of the <code>Grob</code> relative to the size of the plotting area.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;grob&quot;</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">3</span>, <span class="at">vp.width =</span> <span class="fl">0.5</span>,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">label =</span> grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Isoquercitin, <span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">theme_bw</span>(<span class="dv">12</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p><code>geom_grob()</code> is designed thinking that its main use will in graphical annotations, although one could use it for infographics with multiple copies of each grob, this would go against the grammar of graphics. In this implementation grobs cannot be mapped to an aesthetic through a scale.</p>
<p>As implemented, there is no limitation to the number of insets and faceting is respected. If the base plot shows a map or a bitmap, multiple simple grobs (e.g. national flags) could be superimposed on different countries. The size of the insets is set relative to the main plot, so the combined plot can be scaled.</p>
<p>Please see section <strong>Normalised Parent Coordinates</strong> below for a description of <code>geom_grob_npc()</code>.</p>
</div>
<div id="geom_vhlines" class="section level3">
<h3>geom_vhlines</h3>
<p>This is a convenience geometry that adds both vertical and horizontal guide lines on the same plot layer, using the same syntax as <code>geom_hline()</code> and <code>geom_vline()</code> from package ‘ggplot2’.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vhlines</span>(<span class="at">xintercept =</span> <span class="fu">c</span>(<span class="fl">2.75</span>, <span class="dv">4</span>), <span class="at">yintercept =</span> <span class="dv">27</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Engine displacement (l)&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Fuel use efficiency (MPG)&quot;</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Engine cylinders</span><span class="sc">\n</span><span class="st">(number)&quot;</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="normalised-parent-coordinates" class="section level3">
<h3>Normalised Parent Coordinates</h3>
<p>R’s ‘grid’ package defines several units that can be used to describe the locations of plot elements. In ‘ggplot2’ the <em>x</em> and <em>y</em> aesthetics are directly mapped to <code>&quot;native&quot;</code> or data units. For consistent location of <strong>annotations</strong> with respect to the plotting area we need to rely on <code>&quot;npc&quot;</code> which are expressed relative to the size of the grid viewport. The plotting area in a ggplot is implemented as viewport and support for <code>&quot;npc&quot;</code> coordinates is relatively easy to implement.</p>
<p>To support <code>&quot;npc&quot;</code> positions we have implemented <em>scales</em> for two new <em>aesthetics</em>, <code>npcx</code> and <code>npcy</code>. These are very simple continuous scales which do not support any transformation or changes to their limits, both of which would be meaningless for <code>&quot;npc&quot;</code> units. Variables mapped to these aesthetics can be either numerical with values in the range zero to one or character. A limited set of strings are recognised and converted to <code>&quot;npc&quot;</code> units: <code>&quot;bottom&quot;</code>, <code>&quot;center&quot;</code>, <code>&quot;top&quot;</code>, <code>&quot;left&quot;</code>, <code>&quot;middle&quot;</code>, <code>&quot;right&quot;</code> (<code>&quot;centre&quot;</code> is a synonym for <code>&quot;center&quot;</code>).</p>
<p>To make these scales useful we need also to define <em>geometries</em> that use these new aesthetics. Package ‘ggpmisc’ currently provides <code>geom_text_npc()</code>, <code>geom_label_npc()</code>, <code>geom_table_npc()</code>, <code>geom_plot_npc()</code> and <code>geom_grob_npc()</code>.</p>
<p>As is the case for <code>geom_text()</code> and <code>geom_label()</code> from package ‘ggplot2’, <code>&quot;bottom&quot;</code>, <code>&quot;center&quot;</code>, <code>&quot;top&quot;</code>, <code>&quot;left&quot;</code>, <code>&quot;middle&quot;</code>, <code>&quot;right&quot;</code>, plus <code>&quot;inward&quot;</code> and <code>&quot;outward&quot;</code> can be used, as well as numeric values, to control the justification. Justification defaults to <code>&quot;inward&quot;</code> in the geometries described here.</p>
<p>While the usual <em>x</em> and <em>y</em> aesthetics are used whenever the positions of plot elements represent data values, these new scales and geometries are useful only for annotations, i.e., in those cases when we want plot elements at specific positions within the plotting area irrespective of the ranges of the data mapped to the <em>x</em> and <em>y</em> aesthetics. When writing scripts or functions that may be applied to different data sets these new <em>aesthetics</em> help by keeping the code concise and reusable. These <em>geometries</em> are used by default by several of the statistics described in later sections.</p>
<p>As an example let’s imagine that we want to add the structure of a metabolite to a plot. Its position has nothing to do with the data mapped to <em>x</em> and <em>y</em>, so it is conceptually better to use <code>&quot;npc&quot;</code> coordinates. The big practical advantage is that this also allows to keep this part of the plot definition independent of the data being plotted, giving a major advantage in the case of plots with facets with free scale limits. This example can be easily adapted to <code>geom_plot_npc()</code> where a ggplot should mapped to <code>label</code>, and to <code>geom_table_npc()</code> where a data frame should be mapped to <code>label</code>.</p>
<p>We produce the example plot by first constructing a tibble to contain the grob and the coordinate data, and then map these variables to aesthetics using <code>aes()</code>. In the example the tibble has a single row, but this is not a requirement. In this respect these geoms behave as normal geoms, with facets also supported.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>file.name <span class="ot">&lt;-</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Robinin.png&quot;</span>, </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">package =</span> <span class="st">&quot;ggpmisc&quot;</span>, <span class="at">mustWork =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>Robinin <span class="ot">&lt;-</span> magick<span class="sc">::</span><span class="fu">image_read</span>(file.name)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">y =</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>flavo.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fl">0.02</span>,</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="fl">0.95</span>,</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">height =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>,</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>                   <span class="at">grob =</span> <span class="fu">list</span>(grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Robinin)))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data.tb, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_grob_npc</span>(<span class="at">data =</span> flavo.tb, </span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">label =</span> grob, <span class="at">npcx =</span> x, <span class="at">npcy =</span> y, </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">vp.width =</span> width, <span class="at">vp.height =</span> height)) <span class="sc">+</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">55</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Alternatively, we can pass constant values to <code>geom_grob_npc()</code> to obtain the same plot. This approach can be handy in simple cases.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data.tb, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_grob_npc</span>(<span class="at">label =</span> <span class="fu">list</span>(grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Robinin, <span class="at">width =</span> <span class="dv">1</span>)), </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">npcx =</span> <span class="fl">0.02</span>, <span class="at">npcy =</span> <span class="fl">0.95</span>,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">vp.width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">vp.height =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">55</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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oosu6tWr12OPPabb2APOHP/PzMxUSk2dOvX88883VwFs2rSprUUhlO3bt5tPkdZ6zpw58a4OgJgi4BPa1KlTtdYHHXSQUmrjxo1a62uvvdb76jfddJPWeuHChUqpCy64QGv93XffKaU+++wzrfXUqVMjq9Vf/vIXrfW7776rlDKRP27cuMiKWrlypdb6008/VUrNnz9fax3xFfPWu/XWW80+kDNn9uzZQaeDKikpMRPOKIrRGuQAQILqwKMGbcQh+lYXNqeoI/Doo4+KyOLFi9u63VBWr14draLghfm2Tp48edKkSSLy9ddf61///4O+F+6ZlZWVOtgh+gEDBkjz2RwAyYhD9DYwB9gjcOmll2qtx48fH62anHfeedEqCh5prRcsWLBo0aKsrKxu3bp5XOuaa64REZ/PN3HixKAL9OnTR2u9bNmyaNUTQIIg4IFE99Zbb7kfbtu2zZl2jrcHXXHWrFkPPPCAUqpPnz6mz0RLy5Yt8zI4AYCkw0h2QKJITU3ds2ePmdaunoYHH3ywe7F+/fo5085iLTP+m2++mTVrlv51j0X3wzfeeEOar2wMtYsAIHnRggcSQkpKyp49e8yZM/l1YJur3Y499ljz8L333nvxxRdbLbBbt27aw/UIf/zjH0l3wEoEPJAQtNbOLXlaBrPWesuWLc4B+bPOOit8aWeddZbH2H7yySedvQoANum8AT9w4EDn53K//fYbOHBgbLY7adKkAQMG0GZCS927dw/zrNMz1rkvkTuVAxK6trbW4+2LBg4ceMghhzjfhQMPPLD9dxEEkAiSL+DdXYrMfcYCFsjIyAjV8+icc87p1auXeaqiosIM4iYiI0aMKC8vN/MHDBjw/vvvR73aQ4cONeVXVVUtXLhQa923b19zhRJgfPvttwFzzGcmPz/feejlxrtpaWnmvgZh5Ofnm8IvvPDCLVu2SPOoOK+//vqll15qnho8eHBA33vlcu+995o527dvd5719DoBxEaUL8drB4/XwburvWvXroCX8PDDDztzVPNNVJ1hWG699daWY3O+99577kKeeuopJ3cnTpwY8cvRWk+ePPmEE04wRS1ZsiToa/FYlLQYZzRiUSwkoT4/yW7p0qUiMn369JdffllErrzySjN/586dS5Yscb6wATcoCirU+3LFFVc45TzyyCPOfNNrr+XyTz/99JFHHmmWv/zyy833wjxlxsUz2/L7/eG3C6BD2TMWvfm5mT59+vTp080PlvvZiRMnmhFY3aqqqryU2XJ+RUWFeeqQQw559NFH3U8dffTRoXaSpk2bZuZfccUVW7duDbNd0zILXzenhpqAt92CBQvMJ6eioiLoAibgzTIlJSVhlnEe1tbWmvsXiMicOXMaGhoCln/iiSdExIyTGMZzzz1nPtLuDZm/48aNKy0tLS0t5fMAxIVtA90c2Mw8vP/++2+99Vb59QF8x4UXXhi+tB07dojInXfeGTD/2muvNf+mmTNnvv7666bwsrKyo4466qOPPjJPmXHdm5qa/vznP5sFunfvbp566KGH3PsBLb3wwgsisnXr1ra8dNhJKTV58mTzyQk/ILFZpkePHs6B9Lvvvts8ZQ6bp6amOuPa5uXlDR8+3KxSUlLitMgdl1xyiYiYu/mFcf7554tI0NFyunfvnpqampqa6vWlAoiNDtqhiEB7DtGLyMSJE0tKSi6//HLn2X//+9/eX2Cb/hsi8uGHH7ofelyxpeeff97L6kIL3mqm7d7qYhLsEP26devOPvvsgO/1xIkTvdwn8LjjjhMPNyc0srOz8/LyzHRTU5NwiB5IDLYdojfT7nPwIrJixQpnAXO71enTp3uvgPeMD1isnb9rRx999O233+5li8rbjduD2rhx4+OPP64J+ITk/YMX/hz8pEmTvG/U5/O1dS/fLG8Okl122WWagAcSQKj0TL6R7AYOHOhc/5OamuocWly8ePH5559vXtWAAQNmzZo1d+7cKVOmeC+5S5cuP/3006uvvtrqzVhFZM6cOeZubGZPoj22bt2qlLrppptaXdLjhU8BmpqaevXqJcGuro5YFIuyyfbt282gNG2SkpIyfPjwqFRg0aJF3hfOyMgQkc2bN3tfRWs9ePDg77//fsOGDc4c97PeiwLQ4WKzf+FFe+4mJyInnnjioYce2s46ePyfLF68WETuvvvu66+/XkSuv/76dm539uzZ7u5LLZkeBhdffHFbSzaNLXMF1IQJE0QkKytLRAoKCiKvrtY33nijiGRmZoqIz+drT1F2MGFpmAFivfP+NRRvvei9OOiggxLtFwBAZEKlp9IJs9Odk5PjNAvixcShUspLW9m5DC9am261qDZtcfv27enp6c5rCVi3PZWPYlHWcL99Xt5K94rTp0+/5557PC68a9euqHRn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" style="display: block; margin: auto;" /></p>
<p>We can also use <code>annotate()</code> if the annotation should be the same for all panels, or if we have a single figure panel. In this case there is no need to wrap a single <code>grob</code> in a list.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data.tb, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;grob_npc&quot;</span>, <span class="at">label =</span> grid<span class="sc">::</span><span class="fu">rasterGrob</span>(<span class="at">image =</span> Robinin, <span class="at">width =</span> <span class="dv">1</span>), </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">npcx =</span> <span class="fl">0.02</span>, <span class="at">npcy =</span> <span class="fl">0.95</span>, <span class="at">vp.width =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="at">vp.height =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">55</span>, <span class="at">x =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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8ICT64oB30G1tbXLli0LDw8XQoSGhv75z39ud1EbN260vhd6Q0PDqlWr2vFLasOALy4u7njAq6paVVX1wAMPpKSkNNmZUVXVXbt2Pfnkkx3ZRUJCgvkJEkVRrNkqLi6uTf9hg8EQGBj43HPPtbl+jfz1r39dvXq1lc936bgTJ05MnTrVz89PuwWxuTcCgOtqLj0V1ezKnGMlJibu3LnT0bXoLJ6enm16mogWVG3axblz5woLCwcNGtTGqll6//33R48e7ebmdujQodGjR5u/FBgYePHiRW06Pj7++PHjQoi6ujrtbMfy5cuXLVvWpn25ublp10ra7dy5c+Hh4ZcuXfLz84uNjR03btxrr73W8iZlZWWhoaF9+vTRHjEMAC6tufR0yefBu6Lz58/PmDHD0bWwiodHG54xWF1d7evrqx0tbt26VRsmyEr/9m//tm/fvrZX8F9069attrZ2wIABISEhn332WavpLoQIDQ0VQpDuAOQmyeNinV9gYOAvv/zi6FpYJTg42PqVx40bt3//fm3622+/bdPBwcaNG9evX9+2yjXF09NTH52tVbNmzRJCNO6MBgCSoQVvPz/88EN8fLyiKIGBgRs3btQWDh8+XF8hNjbWMTVrC+WyEydOCCGqq6u1/mKawMDA+vp6a8oZN26c9iw+a1RWVur3cHfEpUuX3n77bSHEli1bOl4aADgzAt5+YmJitF5aFy9evPfee3/++WchhHlu6ffmOTO9+4Y2HK+Pj8/p06f1Vy9cuGBNI760tFQIERAQ0PJqFRUV9913n7u7u7+/v7+/v6IogwcPzs7ObnfltS7i999/f7tLAABXQcDbz9mzZ2+55RZt+sKFC1OmTLH5LkJCQmxeZsu+/PLL+Ph4rf/gvffeO2TIECFEq70Nrr766pycnOZeraiouP/++z08PAICArS7ufSX9u7dO3nyZEVRAgICZs6caX5s0aoVK1ZUVVUJITIyMqzfCgBcFAFvPz169NCnvby8jhw5IoQwGo1zL3NYzZrRs2dPiyW9evXSp7WBS318fPbv39+nT5/u3bv7+/v/8MMPQogNGzZERERkZWU1WWx2dvaDDz6oKIrF8urq6kcffVQL77Vr1+pP/dGebao9RCc/P/+2227TZjdt2tSzZ09FUa655hp9SJbm1NTUaEMV3XfffW35HwCAy+rk2/PawNnug7c5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" style="display: block; margin: auto;" /></p>
<p>Two additional geometries are based on existing ‘ggplot2’ geometries. They are based on <code>geom_text()</code> and <code>geom_label()</code>. We give an example using <code>geom_text_npc()</code> to produce a “classic” labelling for facets matching the style of <code>theme_classic()</code> and traditional scientific journals’ design.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>corner_letters.tb <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">label =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>                            <span class="at">y =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">cyl =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">8</span>))</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy)) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>cyl, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_npc</span>(<span class="at">data =</span> corner_letters.tb,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">aes</span>(<span class="at">npcx =</span> x, <span class="at">npcy =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="marginal-markings" class="section level3">
<h3>Marginal markings</h3>
<p>‘ggplot2’ provides <code>geom_rug()</code>, <code>geom_vline()</code> and <code>geom_hline()</code>. Rug plots are intended to be used to represent distributions along the margins of plot. <code>geom_vline()</code> and <code>geom_hline()</code>are normally used to separate regions in a plot or to highlight important values along the <em>x</em> or <em>y</em> axis. When creating plots it is sometimes useful to put small marks along the axes, just inside the plotting area, similar to those in a rug plot, but like <code>geom_vline()</code> and <code>geom_hline()</code> in their purpose.</p>
<p>Three <em>geometries</em> provide such markers: <code>geom_margin_point()</code>, <code>geom_margin_arrow()</code>, and <code>geom_margin_grob()</code>. They behave similarly to <code>geom_vline()</code> and <code>geom_hline()</code> and their positions are determined also by the <code>xintercept</code> and <code>yintercept</code> aesthetics.</p>
<p>In the example below we indicate the group medians along the <em>x</em> axis with filled triangles.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>data.tb <span class="ot">&lt;-</span> mpg <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">hwy =</span> <span class="fu">median</span>(hwy), <span class="at">displ =</span> <span class="fu">median</span>(displ))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_x_margin_point</span>(<span class="at">data =</span> data.tb,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">aes</span>(<span class="at">xintercept =</span> displ, <span class="at">fill =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="statistics" class="section level2">
<h2>Statistics</h2>
<div id="stat_centroid" class="section level3">
<h3>stat_centroid()</h3>
<p>It can be useful to mark the centroid of a group of observations with a point or with a label. By default <code>stat_centroid()</code> applies function <code>mean()</code> to both <code>x</code> and <code>y</code> by group. If all the values mapped to <code>label</code> within each group are identical, this value is copied to the returned <code>data</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">shape =</span> <span class="st">&quot;cross&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Other functions can be passed to this statistic as long as they return a single value that can be mapped to the <code>x</code> and <code>y</code> aesthetics (numeric, time or a factor).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(displ, hwy, <span class="at">colour =</span> <span class="fu">factor</span>(cyl))) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.33</span>) <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_centroid</span>(<span class="at">shape =</span> <span class="st">&quot;cross&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">.fun =</span> median)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The very similar <code>stat_summary_xy()</code> accepts different functions for <code>x</code> and <code>y</code>.</p>
</div>
<div id="stat_quadrant_counts-and-geom_quadrant_lines" class="section level3">
<h3>stat_quadrant_counts() and geom_quadrant_lines()</h3>
<p>This statistic automates the annotation of plots with number of observations, either by quadrant, by pairs of quadrants or the four quadrants taken together (whole plotting area). Its companion geometry, <code>geom_quadrant_lines()</code> is used in the examples to highlight the quadrants.</p>
<p>We generate some artificial data.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4321</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># generate artificial data</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">99</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">length</span>(x), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">abs</span>(x))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                      y, </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">group =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</span></code></pre></div>
<p>Using defaults except for color.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">250</span>, <span class="dv">250</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Pooling quadrants along the <em>x</em>-axis. (<code>pool.along = &quot;y&quot;</code> pools along <em>y</em>.)</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pool.along =</span> <span class="st">&quot;x&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pool.along =</span> <span class="st">&quot;x&quot;</span>) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Manual positioning of the text annotations and pooling of all four quadrants, and overriding the default formatting for the label.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">quadrants =</span> 0L, <span class="at">label.x =</span> <span class="st">&quot;left&quot;</span>, </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">sprintf</span>(<span class="st">&quot;%i observations&quot;</span>, <span class="fu">stat</span>(count))))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Annotation of only specific quadrants.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">quadrants =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using facets, even with free scale limits, the labels are placed consistently. This achieved by the default use of <code>geom_text_npc()</code> or as shown below by use of `geom_label_npc(). We expand the <em>y</em> limits to ensure that no observations are occluded by the labels.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(my.data, <span class="fu">aes</span>(x, y, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_quadrant_lines</span>() <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_quadrant_counts</span>(<span class="at">geom =</span> <span class="st">&quot;label_npc&quot;</span>) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">260</span>, <span class="dv">260</span>)) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_apply_group-and-stat_apply_panel" class="section level3">
<h3>stat_apply_group and stat_apply_panel</h3>
<p>These statistics apply a function to <code>x</code> and <code>y</code> data. The function is expected to return a vector of the same length as its input. It is usually better to apply such functions through mappings using <code>aes()</code> when they are independent of grouping or to use a transformation for the scale. However, when grouping is important, these statistics solve a problem that would otherwise require pre-computation of the data. Here we plot the difference in circumference between dates for each tree. (As the vector returned by <code>diff()</code> is one element shorter than its input, we prepend <code>NA</code>.)</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(Orange, <span class="fu">aes</span>(age, circumference, <span class="at">colour =</span> Tree)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_apply_group</span>(<span class="at">.fun.y =</span> <span class="cf">function</span>(x) {<span class="fu">c</span>(<span class="cn">NA</span>, <span class="fu">diff</span>(x))}, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_peaks-and-stat_valleys" class="section level3">
<h3>stat_peaks() and stat_valleys()</h3>
<p>Two statistics make it possible to highlight and/or label peaks and valleys (local maxima and local minima) in a curve. Here we use a time series, using <code>Date</code> objects for <code>time</code> and the default formatting of labels. We also instruct <code>geom_text()</code> not to render overlapping labels. They support numeric, date or datetime mapped to the <em>x</em> aesthetic. Currently a numeric variables has to be mapped to the <em>y</em> aesthetic.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lynx, <span class="at">as.numeric =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_peaks</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_peaks</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="sc">-</span><span class="dv">100</span>, <span class="dv">7300</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using numeric values for <code>time</code> and the default formatting of labels. We can also pass other aesthetics recognised the <code>geom_text()</code> such as <code>angle</code>. Here we also highlight and label the valleys.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lynx) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_peaks</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_peaks</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_valleys</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_valleys</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">hjust =</span> <span class="fl">1.2</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">900</span>, <span class="dv">8000</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using Date for <code>time</code> but supplying a format string. In addition marking both peaks and valleys.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lynx, <span class="at">as.numeric =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_peaks</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_peaks</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.2</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">x.label.fmt =</span> <span class="st">&quot;%Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_valleys</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_valleys</span>(<span class="at">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">hjust =</span> <span class="fl">1.2</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">angle =</span> <span class="dv">90</span>, <span class="at">check_overlap =</span> <span class="cn">TRUE</span>, <span class="at">x.label.fmt =</span> <span class="st">&quot;%Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">900</span>, <span class="dv">8000</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using <code>geom_rug</code> for the peaks and valleys.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(lynx, <span class="at">as.numeric =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_peaks</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_peaks</span>(<span class="at">geom =</span> <span class="st">&quot;rug&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_valleys</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_valleys</span>(<span class="at">geom =</span> <span class="st">&quot;rug&quot;</span>, <span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_dens2d_labels-and-stat_dens2d_filter" class="section level3">
<h3>stat_dens2d_labels() and stat_dens2d_filter()</h3>
<p>These stats had their origin in an enhancement suggestion for ‘ggrepel’ from Hadley Wickham and discussion with Kamil Slowikowski (ggrepel’s author) and others. In fact the code is based on code Kamil gave during the discussion, but simplified and taking a few further ideas from <code>ggplot::stat_dens2d</code>.</p>
<p><strong>Warning!</strong> Which observations are selected by the algorithm used, based on <code>MASS:kde2d</code>, depends strongly on the values of parameters <code>h</code> and <code>n</code>. You may need to alter the defaults by passing explicit arguments to these stats. Beware, though, that what are good values, may depend on individual data sets even if they include the same number of observations. For the selection of observations to work cleanly, the argument for <code>n</code> must create a dense grid. Much larger values of <code>n</code> than in the examples in the documentation of <code>MASS::kde2d</code> and <code>ggplot2::stat_dens2d</code> will be needed in most cases.</p>
<p>Some random data with random labels.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>random_string <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">len =</span> <span class="dv">3</span>) {</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">sample</span>(letters, len, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make random data.</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">50</span>)),</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab =</span> <span class="fu">replicate</span>(<span class="dv">100</span>, { <span class="fu">random_string</span>() })</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The stat <code>stat_dens2d_filter</code> <em>filters</em> observations, in other words passes to the geom a subset of the data received as input. The default argument for <code>geom</code> is <code>&quot;point&quot;</code>.</p>
<p>Using defaults except for the color aesthetic. Highlight 1/4 of observations from lowest density areas of the plot panel.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Keep at most 20 observations.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>, <span class="at">keep.number =</span> <span class="dv">50</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Keep always 50 observations.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span>, <span class="at">keep.number =</span> <span class="dv">50</span>, <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Highlighting 1/4 of the observations by under-plotting with larger black points.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_dens2d_filter</span>(<span class="at">keep.fraction =</span> <span class="fl">0.25</span>,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A different way of highlighting 1/4 of the observations, using over-plotting with a ‘hollow’ shape. We also shift one group with respect to the other.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">2</span>)), </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                     y, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_dens2d_filter</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">keep.fraction =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Highlight 1/4 of observations from lowest density areas of the plot, with density considered separately for each individual group. In this case grouping is based on the color aesthetic.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>), <span class="fu">rep</span>(<span class="dv">50</span>,<span class="dv">2</span>)), </span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                     y, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_dens2d_filter_g</span>(<span class="at">shape =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">keep.fraction =</span> <span class="fl">0.25</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The stat <code>stat_dens1d_labels</code> <em>replaces</em> the values of the label (aesthetic) variable in <code>data</code> based on density of observations along the <em>x</em> or <em>y</em> axis in the plot panel. The replacement is given by the argument passed to <code>label.fill</code>, which can be a character string or a function accepting a character string as argument and returning also a character string.</p>
<p>The default value for <code>geom</code> is <code>&quot;text&quot;</code>. The default value of <code>label.fill</code> is <code>&quot;&quot;</code> which results in empty labels, while using <code>NA</code> as fill label results in observations being omitted. Using <code>NA</code> as <code>label.fill</code> is similar to using <code>stat_dens2d_filter</code> as long as the geom used requires a <code>label</code> aesthetic.</p>
<p>Label 1/10 of observations from lowest density areas of the plot panels.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y, <span class="at">label =</span> lab, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_labels</span>(<span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">10</span>, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hjust =</span> <span class="st">&quot;outward&quot;</span>, <span class="at">vjust =</span> <span class="st">&quot;outward&quot;</span>) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Using the geoms from package ‘ggrepel’ avoids clashes among labels or on top of data points. This works with versions 0.6.0 and newer of ‘ggrepel’. One example with <code>geom_text_repel</code> follows.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y, <span class="at">label =</span> lab, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_labels</span>(<span class="at">geom =</span> <span class="st">&quot;text_repel&quot;</span>, </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">keep.fraction =</span> <span class="fl">0.45</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>With <code>geom_label_repel</code> one usually needs to use a smaller value for <code>keep.fracton</code>, or a smaller <code>size</code>, as labels use more space on the plot than the test alone.</p>
<p>Additional arguments can be used to change the angle and position of the text, but may give unexpected output when labels are long as the repulsion algorithm “sees” always a rectangular bounding box that is not rotated. With short labels or angles that are multiples of 90 degrees, there is no such problem. Please, see the documentation for <code>ggrepel::geom_text_repel</code> and <code>ggrepel::geom_label_repel</code> for the various ways in which both repulsion and formatting of the labels can be adjusted.</p>
<p>Using <code>NA</code> as argument to <code>label.fill</code> makes the observations with labels set to <code>NA</code> <em>incomplete</em>, and such rows in data are skipped when rendering the plot, before the repulsion algorithm is active. This can lead to overlap between text and points corresponding to unlabelled observations. Whether points are occluded depends on the order of layers and transparency, the occlusion can remain easily unnoticed with <code>geom_label</code> and <code>geom_label_repel</code>. We keep <code>geom_point</code> as the topmost layer to ensure that all observations are visible.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y, <span class="at">label =</span> lab, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_labels</span>(<span class="at">geom =</span> <span class="st">&quot;label_repel&quot;</span>, </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">keep.fraction =</span> <span class="fl">0.35</span>, </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label.fill =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="stat_dens1d_labels-and-stat_dens1d_filter" class="section level3">
<h3>stat_dens1d_labels() and stat_dens1d_filter()</h3>
<p>These stats are similar to <code>stat_dens2d_labels()</code> and <code>stat_dens2d_filter()</code> but compute the density in a single dimension, either the <em>x</em> or <em>y</em> aesthetics.</p>
<p><strong>Warning!</strong> Which observations are selected by the algorithm used, based on <code>stats::density</code>, depends strongly on the values of parameters <code>bw</code>, <code>adjust</code> and <code>kernel</code>. You may need to alter the defaults by passing explicit arguments. Beware that what are good values, may depend on individual data sets even if they include the same number of observations. For the selection of observations to work cleanly, the argument for <code>n</code> must large enough to generate a dense grid or the bandwidth may need to be increased by passing a number &gt; 1 as argument. Increasing the bandwidth makes the empirical density function smoother, and the selection of points less dependent on immediate neighbors.</p>
<p>We use the same data as in the previous sections.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>random_string <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">len =</span> <span class="dv">6</span>) {</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="fu">sample</span>(letters, len, <span class="at">replace =</span> <span class="cn">TRUE</span>), <span class="at">collapse =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make random data.</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">rnorm</span>(<span class="dv">100</span>),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">50</span>)),</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab =</span> <span class="fu">replicate</span>(<span class="dv">100</span>, { <span class="fu">random_string</span>() })</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>The stat <code>stat_dens1d_filter</code> <em>filters</em> observations, in other words passes to the geom a subset of the data received as input. The default value for <code>geom</code> is <code>&quot;point&quot;</code> and the default <code>orientation</code> is <code>&quot;x&quot;</code>.</p>
<p>Using defaults except for the color aesthetic, we highlight 1/4 of observations from lowest density region along the <em>x</em> axis of the plot panel.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens1d_filter</span>(<span class="at">keep.fraction =</span> <span class="fl">0.25</span>,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAllBMVEUAAAAAADoAAGYAOpAAZrYzMzM6ADo6AGY6kNtNTU1NTW5NTY5NbqtNjshmAABmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2ryKur5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k////AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T////0mONJAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAK7ElEQVR4nO3dj3fUxBqH8Yhyr6sUFQHrFcu1RVjqUsn//89JSovbNEkzk5l5v+/M8zkeDxw2myH7MJnsr3Y9IKyzHgCwhEAhjUAhjUAhjUAhjUAhLSTQx0AxMYEG3BbYhEAhjUAhjUAhjUAhjUAhjUAhjUAhjUAhjUAhjUAhjUAhjUBldR1vMSNQXV1HoT2B6iLQawSqikCvEags+hwQKKQRKKQRKKQRqDnWmksI1BpX64sI1BqBLiJQawS6iEDN0eeSlYEeftztTsfbANmtC/Tq5Vl/+OlstA2Q3bpAL08+/e/8dgolUBSzfg06zKI3XxyWdUTAkdWBfnz1fLwNkN3aQK9efOmTQFHO6qv4039/Q6AoZl2gd/okUJSzLtC3uwFX8SiOV5IgjUArtN/vrYeQDIHWZ7+vqFACrQ+B5hgIkiHQHANBOhX1SaDQRqCQRqCQRqCQRqCQRqCQRqA6+HjnBAKVwQfkpxCoDAKdQqAyCHQKgeqgzwkECmkECmmJA63pfTRQkDbQqt6JCAUECmkECmmsQSGNq3hII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII1BII9DP+ESlKAK9xmfSVRHoNQJVRaDXCFQVgX5Gn6IIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIINBavPRVBoJF49b4MAo1EoGUQaCQCLYNAY9FnEQSaCL3mQaBpTJzxSTYFAk3jfqAsUpMg0DQINBMCTWTqDE+g2xFoNvSZAoFCGoFCGoFCGoFCGoFCGoFCGoFCGoEOeMpSFoH2vOijjEB7AlVGoD2BKlsd6OHZxXibetCnrLWBXu6+Lxzofr8vsh9IWxno+Xe/F55B9/vWCj2expnSb4We4h8Pso7oRnOBHi+EWRR/IbsGJVDT0ciQDbS5NSiBTtINtDmsQacQKKQRKKTxShKkESikESikESikESikESiktRcoz4G70lygvIroC4FCGoFCWnOBsgb1pb1A4QqB3s6pzKySCPRmVcraVBOBEqg0AiVQaQR6myZ9SiJQ0pRGoJBGoJBWbaCct+tQa6BclFeCQMsxGJH/r2dpKFDrYlP8mwm8hwq+4KrWQAV/+nCCAYTeBYE6QqAuEWjREWy/h+Bz/MZdWmsn0Lk+rLMN4mqwSTQU6DT7iRVLCJRApREogUprPtAGl3WuECikNRNowYmSOTmhigO9s7gsuNRkVZtSvYF2d0IhUKcINM+Oy+yqAa0EyhrUKeeBLrXARFYD34EqnU11RlIVAk1EaChVIdBEhIZSFd+BCp1XtwSq87fQ4zNQxffhbuqTQue4DLSCTzIcI9AFU4F+ePrVb2u2MUOg7ZieQV933dd/PriNmcoCpdAFc6f4D0+77tsHtrFTV58EumB+DTok+uiPpW2qYpkIgc6bC/RN133z6VQ/eaKvMdD1jeRoiT5nTQb6969d98Pwi/eTU2jTgTLblTV9FT99ah9vU5NaA3W/Wnf5PGgOAWd4R4H6f76DQEN56pNAo8gfM1cNLgoLVPGBMQh0fNDkDouvs/iywD7VHgqFQPUOS+ZAZevXeyR6Ap2SN1Dd+VnvkegV1qCChyX3BCoaqN5iq5e4ilc8LBkJB6pIINDW0GcIAoU0AoU0AoU0AoU0/4H6u+bwN2JDMoHGPtlk+axN3J55nimESqDRT9cbPtyRu17ajHTHCDRe+kAFJle1l00EAw08RKZn+Phz/NxPvTMOVO6FZ5VA++M+0x2ivI/33L0/uNe5EAn0HplAv0h5iGwe8If3ujSFxu0z1TEj0Ac1HWisdAfNoM/FXa4M9OrF7sm78TaZpD3DSwaafOkhN/EFWB77ukA/vjrt356Mt3HAZklXfq+tB3r1y0V/eHYx2qYwvw9BAY4PTopADz+/669eng23H6QbXADPkwSWJFiDXj65DfR4m7IItEmhM+jxNmURaJNYg0La2qv45z6v4uGd4POgwL/0XkkCjhAopBGoMuv3NgkgUGH2776zR6DCCLTGQCt6TAm0wkCrelAr+qvEIlDvKn+BjUAzKTWK2t+i4DjQgI/1FG626+Y/uJkagc5vYysggcKzakeg6RBoekUDZQ06v40t/UDL7bFifgMNWViWX4OW3F3VHAeKFhBoPCbKAgg0GuvMEgg02kygVJsUgUabDpR5NS0CjTc3gRJoQgSaGIGmRaCp0WdSBJoHmSZCoFlwok+l5UAzNkSgqTQcaM6ICDQVAs1257nuui0tBTqKJjxQqiuvoUDvBXnntyvi47xtoOVAV/9hwG2QGIGu+MOA2yCxhgJdPIuvim9rn/QdrqVAFxWIhxk4AoHmcj/GwECpeVB1oGEPcdogJmoMC5T59lrNgZoGMXV3yzvY/DRtlQg07tbp7268AYFeI9C4W6+6v9DbL7yO0KyaAzVdgwZjxpxUdaC+0OeUpgIlAX9aCpSTqEMECmkECmktBcoa1KGmAo1A08YIdBGrAmsEuqjGQH19qT2BLqow0NkfC6IZLoEuq67P2UBFf54NgbaGQBumNd+GncoJtH5aK9bQ4iT7JNCUVAL9nJrolBjIQ6AljnOSskQCvSmTQAspcaAD0nrg0/WJBrTF7QGroU8C/Wx9oCKz5JI6ps4bIoEuHdHsx7u7sf7GOUeTwPHx8t6qRqDLDSr16SLQI+5nUw+BZlb1F34QaBKeAvWFQNMwPYoV98kaFMiKQCGNQJOqerVggkBTqvp6ywaBpkSgyRFoSgSaHIEmta5PKl6PQMtjng1AoOURaAACLY9AAxCoAfpcj0AhbXWgh2cX423aw9RX3NpAL3ffEyiLx/JWBnr+3e/MoARqIPQU/3iQdUTCCLQ81qAhmu3T7m3PDwd6vtud9AS6RrX9Gn5whBk0nZwrANv2CbQKGQM1Xv0SaBXqDVR6DTq/DUYeimh9ZONbWgdqh0DL2fL9Oq32SaAF1fUFUIU4CdT71w9cI9AIPgJ1+gUu8edp+rxFoPkwDyZAoCHCgiPQBHwEKrIGDf+iRgLdykmgGkKLo8/tCDQAU2J5BBqCPosj0HuoUAmBjnEel0KgYwQqhUDHCFQKgd5Dn0oIFNIIFNIIFNIIFNIIFNIIFNIIFNII1BpPuy4iUGO8cLWMQI0R6DICNUagywjUGn0uIlBII1BII1BII1BIqyxQrjhqU1egPGdTHQKFNAKFtLoCZQ1ancoCRW0IFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNIIFNKiAgWKiQg0KefTsfPh+xk/gcZxPnw/4yfQOM6H72f8vM8X0ggU0ggU0ggU0ggU0qwCPfy4250a7Xuzqxe7J++sB7GBp4NvFOjVy7P+8NOZzc63+vjqtH97Yj2KeK4OvlGgl8Pje+7lX/HI1S8X/eHZhfUwork6+IZr0OEfskuHn9/5HfwNN+O3C/Tjq+dm+97m8on7QP0cfINAz3e7k+FCw8shusf/DOro4NtdxTtZA03wvgZ1dfCNAvV0iO4Zzo+er+JdHXyjQN/uBo6O0x3Onwd1dfB5JQnSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCBTSCDSrN1/91n94+q31MBwj0LxefzP8h2gEmtdf//nff/+wHoRnBJrZm+4H6yG4RqCZve44w29BoHm9f/T/p0yhGxBoVh8+1fn+EYvQeASa1euv/+z//pWTfDwChTQChTQChTQChTQChTQChTQChTQChTQChTQChbR/AG/+V4lrajPmAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>We repeat the example above, we highlight 1/4 of observations, but now from lowest density region along the <em>y</em> axis of the plot panel.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens1d_filter</span>(<span class="at">keep.fraction =</span> <span class="fl">0.25</span>,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">orientation =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In other respects than <code>orientation</code> and the parameters passed internally to <code>stats::density()</code> the examples given earlier for <code>stat_dens2d_filter()</code> also apply.</p>
<p>The stat <code>stat_dens1d_labels</code> <em>replaces</em> the values of the label (aesthetic) variable in <code>data</code> based on density of observations along the <em>x</em> or <em>y</em> axis in the plot panel. The replacement is given by the argument passed to <code>label.fill</code>, which can be a character string or a function accepting a character string as argument and returning also a character string.</p>
<p>The default value for <code>geom</code> is <code>&quot;text&quot;</code>. The default value of <code>label.fill</code> is <code>&quot;&quot;</code> which results in empty labels, while using <code>NA</code> as fill label results in observations being omitted. Using <code>NA</code> as <code>label.fill</code> is similar to using <code>stat_dens2d_filter</code> as long as the geom used requires a <code>label</code> aesthetic.</p>
<p>Label 1/10 of observations from lowest density regions along <em>x</em> in the plot panel. Normally a repulsive geom is most useful.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y, <span class="at">label =</span> lab, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens1d_labels</span>(<span class="at">geom =</span> <span class="st">&quot;text_repel&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Similarly along the <em>y</em> axis.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> d, <span class="fu">aes</span>(x, y, <span class="at">label =</span> lab, <span class="at">colour =</span> group)) <span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens1d_labels</span>(<span class="at">geom =</span> <span class="st">&quot;text_repel&quot;</span>, <span class="at">orientation =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAABZVBMVEUAAAAAADoAAGYAOpAAZrYAv8QAv88Av9gAyuIA1ewzMzM6AAA6ADo6AGY6OpA6kNs6v8Q6v886v9g64PVNTU1NTW5NTY5NbqtNjshmAABmADpmOpBmZmZmtrZmtv9mv8Rmv89m4OJm6uxm6v9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQOjqQOmaQkDqQkGaQtpCQysSQ27aQ2/+Q4NiQ6uKQ9P+rbk2ryKur5P+2ZgC21cS29OK29P+2/7a2//W2///Ijk3I///bkDrb4M/b//Xb///kq27k///4dm34dof4dqD4j7n4ptH5dm35dof5dqD5pqD5vej7dm37dof7vbn71NH71P/8j238pm38vYf8vaD81Ln86f/8/9H8///+vYf+////tmb/yI7/1KD/25D/5Kv/6bn/6dH/6tj/9OL/9Oz//7b//8j//9H//9v//+T//+j//+z///X///92tA9EAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARCklEQVR4nO3di3vT1hmAcUMxl1JGKGmBboNuaekNurUZBQrd1kBYwFAog22UtYw0kDCyhFDQ3z8d+W7L9pF0Lt85en9PEygPRIr8RkeSj+VGAgjW8L0CwDQECtEIFKIRKEQjUIhGoBCtSKBvAno8BWpusYgagUI0AoVoBArRCBSiEShEI9CQbR650P21+9vYEGjIBgL1vCbWEGjICLQIAnVu88hXzeb+FYZ4LQTq3Obc/pXXiwcIVAuBOrc5t9A9QyLQmQjUnWazqX7ZfHspSV6dWiBQHQTqTLPZLpRAiyBQZ3qBqioZ4jURqDO9QDlJKoBA3ekeg6rLTAd4JkkPgfpEoDMRqE/Z+VKECDQO36iRPkYEKl2r1fK9Cj4RqHCtVr0LJVDhCNQYArWBQI0hUCvq3afDQDc+mJ8/Y2GxiJqzQLc/vZRsfHjJ/GIj9N9H7Q84DPTJ8fTTle4ulECnePb9o+wDieNjULUX7dw4zNxi40OgA1wG+vLixxYWG5EX91s3f/r+pzut1t/Tj3u+V0cEh4Fuf9Lrk0DzvLh/O/24+Yg96ACXZ/Fn+v9DoDme3nqcfiLQIc4CHeqTQPOsfvdzdgBKoAOcBXp9XuEsfgoCzcEzSXIwxOcgUDl++aF9kvTi/oNEfRgW5nOmBCrILz+0Wv9Md50PW7ezD6MCnXVCoMJYG9sJlEBNINBhBCqMvbOjIPskUMhGoBCNQKMT1yVUmYE+u/vv1q3H2eSeu487k3xi2urQJjTQO7fV5J576YfqtH39utLKIVBSA33QeeZv9dbj7jOAlVauRtIhfjXdWunP97M72bUl489JuSQ0UDWgt+dO3H3cnUNRaeXC17mh3WxqUz28rf5T1POnISPQQHRvCTpbe66JOnhXHqqtFzDBgbaHdob4tmKBJqudgX311mOba2Wf4EC7J0ndST6VVi54BQPtzDUJ/+dacKDZ5aUf0z1Ad5JPvRU6Bn166z9qvl74fQoNtO9p5xCq9seg+tJNpWaTpkdG2cWQwAkOVP34985BCVRbuqnUmVG66R5mV5nC3osKC3Roxs1q+n/dayQEmi/n1vRxbSpZgQY6Z1GWZ3cDP3EfQqCxMf5aEb8INDSvTjX3nn/728Wj6e+v7ftzpO8+0yMr0EBnfbv06tTR9GPf0rX9K8nrxaOxvj1Sj7BAMcvzfUtqz7mkyoz4DeZ6CDQwas+p3rUr3Xuq3xOoPgJ1oRto8nz/39JGCVRfLIGqZ1ZvPW5fTszulKRu2JnNrZTwvEw2xKtPr94/n2ZKoPoiCTR78mr1u597gd757udktaU+SZgZ1D1J6rz7IYHqiyTQbHbfi/sP+oE+6Ezxl/EUjbrM9FW2G20uEGgRkQS6ml2MTcf03hD/KEn6n0R4rg5E64FAR60Ozp+SF+jzvReS14uRvrVxDgId1Z1DKTTQ5FqzGetbb+ch0FG//JDuQp+qu3TeS39/U1ygNUOgY9RlJrUXVReW/vUPAvWLQCEagUI0AoVoBFoccwIdItDCmFXtEoEWlhfoKjeItIRAC8sJVL0OnYtQVhBoceM7UN4bzhoCNUBd0r/97Psf2/fi7MwnhREEakK2B73TnjLanU/qe50iQaAmtANtTxntzif1vU6RIFATeseg6vbbnfmkZb7O//5ies2CR6AmDAVafnSPfnp8CQRqwmCgFe7JSaDjCNSEwUC780kL/PPNI+fnms2FzfTT0W/UZORrNZqRPAOBmjAYaG8+qb7Nuf0r3buFqFcUv15csLWmwSFQATbn2q/PVIG+OrWQ3ZcBbQRql9a8kuzYs3ujpXR4Z4TvI1Cr9GY+DQW6+fa3jPB9BGpViUBfL/6OEb6PQK0qFqg6/lSvK2aE7yNQuwodg3ZutzTHCN9HoC7p5coIP4BAHRob8HPfPe7aUVfrEwICdWg00Lz338wu2qOHQB3SCRTDCNSl8RGeQGcgUJ/ocyYChWgECtEIFKIRqB28St4QArWDQA0hUDsI1BACNUy94ON2O9Cn6nYj3Dq8GgItavqED3VfEfXReQcwAq2KQAuaMcMzu69I+km9w+c93nyhOgItaFag6rYN2e4zu5EYgVZFoAVpB/rgYfpbAq3KZaAbp69aWKxr049Bszs2ZEN89k5gBFqVw0CfzL/rIlC/N5AfOElKVvtvV+dxjQLnLtAr73ztYg/q+y0OBi4zqZvgdN6urvKXHZj3VK8pUB6G+DcVc4sd4TtQOwZmjtZsEml0x6AEGpfoAo3zbbYI1AAhgcaJY9DqCBTmEShE45kkiEagEI1AIRqBQjQChWgECtEIdLp6XRUXiECnqtnzigIR6FQE6huBTkWgvhHodPTpGYFCNAItpj3bNMo5pzIRaCHt+fpxztqXiUALIVDXCLQQAnWNQAvppEmfzhBoMaTpGIFCNAKFaATaxXNGIk0oZetEY9eXh5bWD/2xsXtp52yjsSdJ1t86l31af+uLRuON8Xc8DTtQnnWXKb+UrROH04/dS+sH0zB3zu7JPnqBHlTN7hn7RwRalZszsLDO8/JLWdu9lCTLKtCTnf9JP/UDPdnZnQ6LLFD3vVa5vKq/toFdxM0vZVmN4OuH2k2uZf+jhvZz/V+3Tpwc/UdhBzr6EHvYo1ZIp8DaEmj5xUpCoDJMGeK7o/rarnM5Q/yhpdF/RKBVVRrhi4zxJZfiw4yTJNVk9yRJ/eHO2V2RniSNyXvE/Z9HTSJ3zSqacpnpi06gSecyU7J+sNH47Xvty0zjfcYWaA4JZ/p1M6WUtZxrnUrOCXyGQGHehGPQ9LAzbxTPECjcmVDKciN3FM/UN9B4j/Tk4rl4iEag+Wxfi2FfrIlA+waisX01m6NZXQTaMxgNgUpBoD0EKhGB9gxFwzGoEDUMdGJ7RCNQ/QL1OpsnrIkaEhBoXZYdKAKty7IDVb9AfQ6z5QKt9bFxjQKV8DiX7FPAmvtSn0CDfZyDXXEjLAW6dWJX/pQn84vVFezjHOyKG1GulK33cvIb3oNezr25Q7XFVhLs4xzsihsxq5T8g6a13xwe/8PRIX7rRKOR89e0FmtDqA8zgU6Rf9q58/mffq1z6xuV6O6xV39qLFY2x70Q6BT5ga7/auXy2MvixwJdziblX84d6EMOVC8Ygxez6txnuUCXDydrM152rF4JmjW8lrsLjT5QLskbUuYYVMWXM3QPn8XnD+26i5Us+ECD2iOXKSUd4dOhO/Jb30yhOcJLDTSsY9oypSyrNsfH+NoEqkVsn/EHuvMHNXqPXwp1Eqi0xz2kx7pDP1AJ31xgT3UOj5z+N2BYe6OOAn36/+ZCDlTABrSxCmIGCQHbl0ArsrAKck6vBGzf4AJNRkZ47xvQyg5USKACDqHCC3SIhA1onKBAJQg60DjR5yAChWgECtEIFKIRKESrZ6CyT/85SxoQQaDFH0+3F1CLLovrTIPCD7TE4+k00MILm/gN1bJbArXNWKBe9qzefyhKTVg+2Gh0XtAxyHegBTpwPMIXH+Pz/omPQP0fbswqJW9LZe/TOf5mNJ6PQY3sFm2Um/81pz7wud8LgebI3VJZoDufSwm0w0Sg7sb+6Y98/nqUaKVqXgEHmr0waQiBFlAmUNNL0fwKBtajwlJKBZodg4693n1GoNufzB+7obnYUsyM8CICNXWo4X8HqGXaapY+Bt05O3qWND3QlxfPJNeP6y7WF3dnT07KqUGgebJAx193PD3Q7c+uJhunr1ZYbDlBPELWhPHdWwm06Ks6Nz66kWx/ekktUimx2FIC2YfUXPlj0FylroM+OdYNtOxiSyHQwDl7Jqm/BzW82OkINHDOAuUYFGU4C/TlxY8DOIuHNO4mi1i/DooYhT+bCVEjUIhGoIGS/aoVcwg0TBJu++MEgYaJQIsLNtAQH2oCLS7UQMN8rENc5zIINNBAZ4rkmyJQf4FaXWwsP3Y1CzT3QRv/Q/uPbfuVmxYXQ6BjAghU81Gz/+C2CFQTgZb/axXYD5Rj0DEEqq/VmnB3BoyoV6C6uxUnx6CWlxCJmgWK0BCobewrKyFQy3hRVDUEalluoDSrjUAtywuUvao+ArUtfwdKoJoI1AMC1UegPtCnNgL1hieSdBCoL7HM5rCMQDUZH5UJVAuB6jF/XkOgWghUj4UTb/rUQaATDQVUKFBO0s0h0ElGhuDB6Gbs+7jMaRCBTjL5GHHW0SOBGkSgkxCoCAQ60cQKZ55/l+6TsMcQaAm2zr/Z9Y4jUI9Gc9QPtD6XqAh0gPb+y9I7aWoHWqOL/ATa57qP8eVNXv7wAgm0DAK1tbyxJRJoGQRaYoGaf3N0ibXpk0AHOT4GLaBGu8wRBBqGuvZJoJPVtglRCHSS+o6qohDoJAQqAoFOQqAiEOhE9CkBgRpCznYQqBkcEFhCoGYEHajkSX4EakbIgeY/xSukWgI1JNw+J97CVEShBAoCtbrY4Ph94HVHcwKtK7+PvP7SZfRJoM55CzQ7SpayY9QWcaDWTluqfWFfibSvMxCo88VOYu3Cj+YXnhiCvx1oZxfqY+mlEailLyxuVxXoldrgA52YgZ0HpKX7LsXiAh08Mgko1dADndKBpT4136VYXqB9Ie1MIw7UhgKLk9sngTpcrNxABSNQh4t1HEwMfXIM6nSxiBqBQjQCdS6g8VUAAnUtpDMUAQjUNQIthEBdI9BCCNS52X3GcS3LDAKVJ45nAwwhUHkIdACBykOgAwhUIPrsI1CI5jLQjdNXLSxWInaBxjgM9Mn8uzUJlINIc9wFeuWdr+uyByVQczwM8W8q5hYrEIGawzGoDVH36fabcxLolfn540mdAp0m9GfiHQ8P7EEdMz9XxP2LXgg0YsYDdX3AS6BxCz7QGI9BrS42NNP61HrsR75A5JcMCFQQrdbGdsFR90mgkpQLNG5RBxravoVAx8UcaABHZyMrWOYYNHIE6pP8NfSOQO0sWPsvEuh0MQfq6xi00DtpEOh0UQfqSRw3ERWCQM1jv2gQgVpAn+YQaAX1uuDjB4GWV7NL5n4QaHkE6gCBlkegDhBoBfRpH4FCNAKFaAQK0QgUohEoRCNQiEagHZtHzs81mwvprxeS7NPrxWbzgO+1AoF2bM7tX0mu7VvqBvp68UCiPnyr+7VWAu3YnFvIwuwG+nzfUpJkn7yq/bNVBNrRDbMXaLpDbf+hVwRq7ksRqAUEau5LRRbo3gsShniOQc19qTgCfXXqaHpytFfMSVLdEWhH7/LS5lyz+fv3ucwkBIFCNAKFaLUPtO4nIdLVPdDaX8aRjkAJVDQCJVDR6h4ox6DC1T5QyEagEI1AIRqBQjQChWgECtEIFKIRKEQjUIhGoBCNQCEagUI0X4ECevwEakJAe2FWVQICnYhVlYBAJ2JVJXAdKFAIgUI0AoVoBArRCBSiOQ5044P5+TNuF1nO9ifzx274Xgk9wWzTUtwGuv3ppWTjw0tOl1nKy4tnkuvHfa+FlmC2aTluA32iHvMrAfy4b392Ndk4fdX3augIZpuW4/4YVP3Ei7fx0Y0wVrQtoFUtynmgLy9+7HqRJTw5FlKgYWzTctwFemV+/rg6+QhiWwa1Bw1km5bj/Cw+jIOlgI5Bg9mm5bgNNJhtqQbNQM7ig9mm5bgN9Pq8EsIGDec6aDjbtBSeSYJoBArRCBSiEShEI1CIRqAQjUAhGoFCNAKFaARawfKuc8nWicO+VyNqBFrF5T3qP1hEoFWsv/XloSXfKxE3Aq1kuXHS9ypEjkArudxghLeLQKtY2/3XE+xCrSLQCrbSOtd2cxBqE4FWcPmNlWTnLIO8TQQK0QgUohEoRCNQiEagEI1AIRqBQjQChWgECtEIFKL9HyyItXCEwg3WAAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>In other respects than <code>orientation</code> and the parameters passed internally to <code>stats::density()</code> the examples given earlier for <code>stat_dens2d_labels()</code> also apply.</p>
</div>
<div id="repulsion-with-ggrepel" class="section level3">
<h3>Repulsion with ggrepel</h3>
<p>When observations are at high density, one needs to use similar functions included in ‘ggrepel’ (&gt;= 0.9.2) together with repulsive <em>geoms</em>. If density is very high, then one can additionally use one of the “density-filter” <em>stats</em> also provided by the package ‘ggpmisc’.</p>
</div>
</div>
<div id="appendix-a-more-on-density-filtering" class="section level2">
<h2>Appendix A: More on density filtering</h2>
<p>We define a function to simplify the generation of random data sets based on different probability distributions.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>make_data_tbl <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">nrow =</span> <span class="dv">100</span>, <span class="at">rfun =</span> rnorm, ...) {</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (nrow <span class="sc">%%</span> <span class="dv">2</span>) {</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    nrow <span class="ot">&lt;-</span> nrow <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1001</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">rfun</span>(nrow, ...),</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">rfun</span>(nrow, ...),</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="fu">c</span>(nrow <span class="sc">/</span> <span class="dv">2</span>, nrow <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In all the examples in this vignette we use colors to demonstrate which data points are selected, but any other suitable aesthetic and discrete scale can be used instead. With <code>keep.sparse = FALSE</code> we keep 1/3 of the observations in the denser region of the plot. Although here we first plot all data points and later overplot the selected ones this is not necessary.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">make_data_tbl</span>(<span class="dv">300</span>), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">keep.sparse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAGACAMAAABFpiBcAAAAjVBMVEUAAAAAADoAAGYAOpAAZrYzMzM6ADo6AGY6kNtNTU1NbqtNjshmAABmtv9uTU1uTW5uTY5ubqtuq+SOTU2OTW6OTY6OyP+QOgCQtpCQ2/+rbk2r5P+2ZgC2/7a2///Ijk3I///bkDrb///kq27k////AAD/tmb/yI7/25D/5Kv//7b//8j//9v//+T///8e2mwfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARmElEQVR4nO2cC5vUthVAnUfbDBCSACEN0EICG7psmP//87qzO57xQ48ryZKvpHO+BHZsSZalM1cPmx2OAIoZ9q4AgAsEBdUgKKgGQUE1CAqqQVBQTYig/wAoRoygAWkBkkBQUA2CgmoQFFSDoKAaBAXVICioBkFBNQgKqkFQUA2CgmoQFFTTlaDDwEtbtdGToMOAodWBoKAaBAXV9CQoc9AK6UpQqA8EBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoETWMYhof/IRMImsQwsndFmqV3QRPdQtDcdC5oqlwImhsETQ6hzEFzgqDYpZrOBSX6aad3QUE5CAqqQVBQDYKCaoSC3j4/HF4v8wBkRybo3au3x9uf3i7yAGRHJujnp/d/vB9DKIJCMeRz0FMUvU9/ImuNACaIBf365sUyTyuwWa8YqaB3Ly9+tiYojzs1I17Fv75+QNB9qay6acgEnfmJoPtSW33TkAn68XCi1VX8Lv0df1EEleapDU39mmAZgkrzVIaqjk2pjKLbyA+CzlMUqouub4tmmhBU1tdeJ4pKg58yWhBUKpYggGKNNnoStFQ5sCGtCxqkHH7qowVBHWJVEBTVV3BfmhDUjn5B9ddwXxB0Z/TXcF8aF1T/AIqgbloXNDMbyIWfThA0hS3DH6IaQdAUNhSUod4MgqbgsCpUNwQ1g6BJuPwM8w1BzSBoHsJ9w08jCJoHAuJGIGgm8HMbEHQvMFgEgqYTpRpzABl1C6qij+NUyyOoigbZlKoF1RGFFAmqo0E2BUH3qkWmAKqgQTYFQWXXSTidjfV1EXSWZ3+K+amx203VUlnRJOoWdGvM/WsRdG8ZlH5vNqYlQZP7a9nl509mE3b3Y/cKFKEhQdM7bFHC5aMtgC4PFxamBz8R1FGCu8D1WVv6LkTKBYIuihAXaAygwlAruz4cFQs69lVAn23evWEBNF3QPmaVYWgVdOwrtX0m3+RB0BQqFnTfzswxcCPomnoFdZ7JWLOcV8HPFVoF9c9BrYISh1pCraBuhjPWc6UrBJnQJqjMLZefCnbQYTuUCSqMft4dyqhSQSEtChqUHHV1U6eggVq596owVDPKBM0U0JwBFEE1o03Q0hQXNOpyHX+J2hTU3aGzswl9f8rqzz5PEfqFeEi9yNSVru0IOuk27yI/9p9KLD2xbXbZ63L+KHXsMfm8jIpnJREVb0bQabcFCxq1eWAX1FEXk3HeK7YiaEzNEdSfwZLMJujNzY2jLqYx23tFUxCuEAQ1fjAldWUWXsP2OOvm5tFQ+9UC38ATHauCrgVNizLygOa9xllQcUHV6hZBz3PQOSWGQZegyaXAGQRNusjpr6WPQX5ea4qnRhoVtGB3uyKmwNVRUCKpmVYFLcdS0Mmny6lZioWI1wCKoAb6EtTjQJQiN3NDp5/Gn2cpLCZOIml4HRqmK0EtG0Oz0+Glzg2NFVSwhd+lu10K6nj1LmyF88ha0ImhqwSBgl4/9jkJ6EPQ6TzP0s2Pu+v2FY/DXPsYb8xs0cws6OQzgobmKU5sB023ctzb61ZBnbub46mHvwP3QWe1PK7uEUHPf9cgaHQPzfYarQHUaZdEu2sZMZU0M73nHv3sS1BHAZP1jPO84bg3TRL7Wrn/d6JNQZfpBHuN9sjpOm9dwLeBgllFTYIGvuYrPz5hoZjPudX6SFhuJSCohPA2srarxM/lY6EAQdPTJbG9TAgqIKKR4ts1VFBpZCwhaA6bdvezTUFl7WpSZiVSqFe+TQDXg4JE5iXvr9Y2tCbomNafxxzUDMduAsKfa5vqXK1shs4KllylCof1CxrUjrMNJXfGoOmj1FBfylRBnVkXAVTwVn8FhlYgaAhLQR23tYmgy+OZBQ3aaENQhQQIGrS+kTxfEj3oTA6g0syiER5BizOZgwo6QOSoO4Au363baL1urvq2TtXgZ3OCTnnsAPfuudhQ75lNBbWZWIVTm1KJoPEdYxJmPBIwDfWfiRHUelt1DL8lqEPQhP4yCHM5JNtpClzBm5Mbj9pvC0FHuhZUtFdvC4mOYkW1ODpvCz/PNC+o8fUPV1AUCro+vKmgcKYOQUMDij251894QSOWY/jpxSTol2ff/C7Jk5/Ah0iTHycZZ2oI1jCyOWjgan2TvaceMUfQd8Pw3Z/ePNkJGQKnaWf55iaJZ5ReUK4ItiH+y7Nh+MGTJyOT50HyHBJBN4mHuFkO+xz0pOi3/3XlycfZsFhBj4sR3jPl9CYyrbOE1fLBLNSDTdA/huH7+6HeONAXEzRyDrp4yClZEjmdcyybFrOHRS5RpTHUiVHQv38bhh9PP/xlDKHlBI3PLM0+yrZS0JBm/Xl6Zj2VEBiKoD7Mq3jz0L7Mk5Hobru8xvSQ3++I0SOfa9MAangWby/YXF1vqp6pZB9UyjAT1CfJ6awphSFkrjMuEz7+fDlit3pZYc8tdU7PglpP2/Mtl1SrOehi+Pfvb4GbFgU9pgpqnRo4llSGwDkb9BE0DqGgdy8PTz4t8ySRaWybr/69I7zkPbp1DkPG6dA+P+aQGvzIBP365vXx49NlnhR2WR0sFZnLtDiz8m1y2BhALcfseUCATNC7Xz8cb3/+sMiTwkXQgp46gphhWWQcmMUFXFPfOC4LXmSC3v7y6Xj36u0p/YkNrjt9VpRxrJ9hNsU4ANsEteOcLSBoNDJBPz8ZBZ3mSWLiZw5BTeXaotx0d2hy2JrFinPiClGERtBpnkiW78UVE9S15xm6nrek3ehNKbhQfg66eu0o/++BiXiV2LRM910zOlReqhrbGA1v90tX8S82W8VbXzvaFvELTTY/ZW8wTY/GCjpdMAa/IzMroEFVy+yDTpvNGDQD2jWiC8LNkQo6P3xjeXTqYfJ04TozDy9g/lMrFHmSNG82s58Bv9IluAuKCBq67L8yzBDf4mKmtPipFXYQNCZBVNJrnvAlkHAOevXxutiKMnT6u3pkt7iYy08ONmVoD4Jas6wHaCuOOehsQyp6W97omzTD4mhLhpZ5WcTbZlnnoKY+W2/P27ZCLWeXJ5Z/m3GcS1gZ+Q7XrGxjbzMZMfTZo0ZOQVfh1fzMcxpC52cMjIk3McZciOFmqw6qPQhq6ErDgOwW1PLWSGDEPCfOaowxgKoW1Fm7LgRdczFztQyfJ5l9nGe2Z7OWUUTQNcoFdVevU0ElU0abajdzQZfDvWticLyM8HG/MiUypbUEFeI2J+gmrSpb06zTH9caTmehJkENxQf6KUwdHCl1hNbWBN2oVW/OT31kfq4ENZ1aC+rbdQrd74xJ6citQ9DW5qDbtaoneq40NJ9YCyq+huhWEgV1ZVciqJNaBJ3tYhcRVDr4z+egQaXIbiVtDuq8hn4/axE0+DmLhK0E9V3EfGIYhix3ZbpMlpLLsLGgdTWzb4TP+aLx2s98TZel3EJsK2i2Zt4jDmT1c3lHtQe6bFQiqKo4sIm5CCqjFkG34r5+vomnr4iNxv5FS2lvuL2oZA66FY9+Wg3zbFtOEm1ftRQmza69B0KpZBW/DQ8B3rRbOVKpoJOBS/8YFkhPgg7bCCqcgxa0GEHNeWpjmBlqTPJ4Ygu3SsZZBDXnqY1r5y2fl8/TbeLW9AFoallemIMa85RhwxY3FrXW0RlgPZeYPvaM/meeK1qzLgD1gsaPWcJ9nABBnbKNk4PFg/lFnqibObdBl5q2K6hoJ9y8YnLuQlku93jOZ3vc3Tzmam56KaJvQV0regMxgs5tR9BQ1AsaPbCJBQ24gGNxdSPaAIiUbBzhETQoj3IEc9BR0CFirb0MltYSlt8TZ41c9Ohny4JKOPs5mAZvj7PCucFgDXx9RsRQOhf0OH3+OT/uE1Am6ICgaSDo8TzCB2/XG06vjUPQRBD0EeMI74uQywc4BuWsftrFdV6nOxoVNKJLV1lsG+yXHy+KjWHS5Nz1iGBb1lqzbP9OIUexm9KmoJYudXWI24LJ2euP40+DS1DLBVIE3cqrKuYYPQka4I/jrEPQgG9AgqCbeYWgu2H2xRmJIgQdC7j4KamT8eL+rPaC4kHQ/Rj9dPVskDGTs+uEsn7WNzJbylGlbaOCPrDqyUyRqDSZq62rXboSNOh0t+hqFxWC5moQT7ma+kERCLpEV4uAqt5A0Py0fXeZQdDtsC+Km7i9fdAgqPoQI95Gsj913/ha/aBCUOUIDdtAUNmWf1cgqJ9EQeVBcUDQFZ0Ieu31iK2nszRec5LlQtA1fQh67faozXvjg1Np5tBq4ueMjgV1BEt3Gf6rJNQzKX+DdCno9SU5e0JHGdcD6ySbVBeu9CHofA56mVLaRnNbEW28a1IXnQg6xSmoN5v1M2ShX0FDB+StBUVvER0KGqvGMluynxgqoEdBVYCgMlQL2nIXIqgMzYK23Yc67k1HLRwgaNfob2IE9Vei7cvt38RONAuao7dCiyzcg6WFQVA5RVoquEMy9mDguwDlKqEKNYKW6RpFgoa+C9ApCOrPUbAq+LmkM0EVDWmmGyaArlAjqCJ1rmSt074jvMbmNqFHUIUYfNm2Xw2P9wt5U02sRlAH617ctl+N5W9WeuCllYKgDqSCxvb1jpYgaAsIBY3u7D0tqcRPBHViXGebUsWH0Kh8HYGg6VQzXNYIgm4AfuYDQUE1CJoVYmsqCJqTyewUVeNA0JxcBWUhFQmC5gRBk0HQrExHeASNAUELocpPVZVxU6mgFbVwJlJaoKZwXqegNbVwKLI7S2qBmpqvV0EL95D8csJbQ1BBnv1IbuHCXRRwuRKC1jRDqlPQ5BauQVB3loocS6JSQVPRK+hx4mcnDjoRCnr7/HB4vcxTM2rnoNMsCCoV9O7V2+PtT28XeZpCnQ0I+oBM0M9P7/94P4bQFgVVqAOv6Z+Qz0FPUfQ+/YmsNdoHhYJG0s6dPCAW9OubF8s8LeHo1sr6uztB3x8O9wP83cuLn00KatfQ1eEaVehO0Adun7++fmhSUCvu2KrQBY11ikcm6MxPBLWfaksODcgE/Xg40fIq3oFzhJ+f0xlSq6apJ0nF9TAEUATdlpYEHXb3Y/cKtAeCbl2FXa/fHggKqmlJUH7De4M0JSi0B4KCahAUVIOgoBoEBdUgKKgGQUE1CAqqQVBQDYKCahAUVIOgoBoEBdUgaDl41yoCBC0Gb6vGgKDFQNAYELQYCBoDgpYDPyNAUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqrpS1BeGa6OrgTlH13UB4KCahAUVNOVoMxB66MvQaE6EBRUg6CgGgQF1SAoqAZBQTUICqpBUFANgoJqEBRUg6CgGgQF1UQJClCMCEE3pNZgTL1Lg6BBUO/SIGgQ1Ls0vMgLqkFQUA2CgmoQFFSDoKCafQS9fX44vN7lyincvTw8+bR3JSKos7XP7CLo3au3x9uf3u5x6QS+vnl9/Ph071qEU2drj+wi6OdTN7+v7Ut99+uH4+3PH/auRjB1tvbIbnPQ0/e6Lm5/+VRhrR+ptd77Cfr1zYudrhzN5yfVClpha48UF/T94fD0tN6or8XqjaA1tvbIXqv4CqdEtc5B62ztkV0ErbPFTuNkjav4Olt7ZBdBPx5OVNdsle6DVtraZ3iSBKpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpB0Kz88c3vxy/Pfti7GhWDoHl59/3pP4gGQfPyv3/++1//3bsSNYOgmflj+HHvKlQNgmbm3cAInwKC5uWvb//zjBCaAIJm5cu9nX99yyQ0HgTNyrvv/jz+/RuDfDwICqpBUFANgoJqEBRUg6CgGgQF1SAoqAZBQTUICqpBUFDN/wEIl71aqwMjcwAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>Here we highlight the observations split in three group equal groups, each of a different density of observations.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">make_data_tbl</span>(<span class="dv">300</span>), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">keep.sparse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The algorithm seems to work well also with other distributions, in this example the uniform distribution.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">make_data_tbl</span>(<span class="dv">300</span>, <span class="at">rfun =</span> runif), <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>One example with the gamma distribution, which is asymmetric.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">make_data_tbl</span>(<span class="dv">300</span>, <span class="at">rfun =</span> rgamma, <span class="at">shape =</span> <span class="dv">2</span>), </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(x, y)) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_dens2d_filter</span>(<span class="at">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="at">keep.fraction =</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="appendix-b-try_tibble" class="section level2">
<h2>Appendix B: try_tibble()</h2>
<div id="time-series" class="section level3">
<h3>Time series</h3>
<p>Several different formats for storing time series data are used in R. Here we use in the examples objects of class <code>ts</code> but several other classes are supported as <code>try.xts()</code> is used internally. The first example is a quarterly series.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(austres)</span></code></pre></div>
<pre><code>## [1] &quot;ts&quot;</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>austres.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(austres)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(austres.df)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(austres.df, <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<pre><code>## $time
## [1] &quot;Date&quot;
## 
## $x
## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(austres.df, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   time            x
##   &lt;date&gt;      &lt;dbl&gt;
## 1 1971-04-01 13067.
## 2 1971-07-01 13130.
## 3 1971-10-01 13198.
## 4 1972-01-01 13254.</code></pre>
<p>The next chunk demonstrates that numeric times are expressed as decimal years in the returned data frame.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>austres.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(austres, <span class="at">as.numeric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(austres.df, <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<pre><code>## $time
## [1] &quot;numeric&quot;
## 
## $x
## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(austres.df, <span class="dv">4</span>)</span></code></pre></div>
<pre><code>## # A tibble: 4 x 2
##    time      x
##   &lt;dbl&gt;  &lt;dbl&gt;
## 1 1971. 13067.
## 2 1971. 13130.
## 3 1972. 13198.
## 4 1972  13254.</code></pre>
<p>This second example is for a series of yearly values.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(lynx)</span></code></pre></div>
<pre><code>## [1] &quot;ts&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>lynx.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(lynx)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(lynx.df)</span></code></pre></div>
<pre><code>## [1] &quot;tbl_df&quot;     &quot;tbl&quot;        &quot;data.frame&quot;</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(lynx.df, <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<pre><code>## $time
## [1] &quot;Date&quot;
## 
## $x
## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lynx.df, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   time           x
##   &lt;date&gt;     &lt;dbl&gt;
## 1 1821-01-01   269
## 2 1822-01-01   321
## 3 1823-01-01   585</code></pre>
<p>Above there is a small rounding error of 1 s for these old dates. We can correct this by rounding to year.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>lynx.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(lynx, <span class="st">&quot;year&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lynx.df, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   time           x
##   &lt;date&gt;     &lt;dbl&gt;
## 1 1821-01-01   269
## 2 1822-01-01   321
## 3 1823-01-01   585</code></pre>
<p>In addition we can convert the POSIXct values into numeric values in calendar years plus a decimal fraction.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>lynx_n.df <span class="ot">&lt;-</span> <span class="fu">try_tibble</span>(lynx, <span class="st">&quot;year&quot;</span>, <span class="at">as.numeric =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(lynx_n.df, <span class="st">&quot;class&quot;</span>)</span></code></pre></div>
<pre><code>## $time
## [1] &quot;numeric&quot;
## 
## $x
## [1] &quot;numeric&quot;</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lynx_n.df, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 2
##    time     x
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  1821   269
## 2  1822   321
## 3  1823   585</code></pre>
</div>
<div id="other-classes" class="section level3">
<h3>Other classes</h3>
<p><code>try_tibble()</code> attempts to handle gracefully objects that are not time series.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 1
##       x
##   &lt;int&gt;
## 1     1
## 2     2
## 3     3
## 4     4
## 5     5</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">try_tibble</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span></code></pre></div>
<pre><code>## # A tibble: 5 x 1
##   x    
##   &lt;chr&gt;
## 1 a    
## 2 b    
## 3 c    
## 4 d    
## 5 e</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="fu">factor</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 1
##   x    
##   &lt;fct&gt;
## 1 a    
## 2 b    
## 3 c    
## 4 d    
## 5 e</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="fu">list</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##       x     y
##   &lt;dbl&gt; &lt;int&gt;
## 1     1     1
## 2     1     2
## 3     1     3
## 4     1     4
## 5     1     5</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>), <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##       x     y
##   &lt;dbl&gt; &lt;int&gt;
## 1     1     1
## 2     1     2
## 3     1     3
## 4     1     4
## 5     1     5</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">try_tibble</span>(<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">ncol =</span> <span class="dv">2</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##      V1    V2
##   &lt;int&gt; &lt;int&gt;
## 1     1     6
## 2     2     7
## 3     3     8
## 4     4     9
## 5     5    10</code></pre>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
